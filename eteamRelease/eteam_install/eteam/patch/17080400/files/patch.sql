
SET client_encoding TO 'SJIS';
SET search_path TO :SCHEMA_NAME;

start transaction;

-- 画面項目制御の修正
CREATE TABLE gamen_koumoku_seigyo_tmp AS SELECT * FROM gamen_koumoku_seigyo;
DELETE FROM gamen_koumoku_seigyo WHERE denpyou_kbn LIKE 'A%';
\copy gamen_koumoku_seigyo FROM '.\files\csv\gamen_koumoku_seigyo.csv' WITH CSV header ENCODING 'SHIFT-JIS';
UPDATE gamen_koumoku_seigyo new SET
  koumoku_name = (SELECT koumoku_name FROM gamen_koumoku_seigyo_tmp tmp WHERE (tmp.denpyou_kbn,tmp.koumoku_id) = (new.denpyou_kbn,new.koumoku_id))
  ,hyouji_flg  = (SELECT hyouji_flg   FROM gamen_koumoku_seigyo_tmp tmp WHERE (tmp.denpyou_kbn,tmp.koumoku_id) = (new.denpyou_kbn,new.koumoku_id))
  ,hissu_flg   = (SELECT hissu_flg    FROM gamen_koumoku_seigyo_tmp tmp WHERE (tmp.denpyou_kbn,tmp.koumoku_id) = (new.denpyou_kbn,new.koumoku_id))
WHERE
  (new.denpyou_kbn,new.koumoku_id) IN (SELECT denpyou_kbn,koumoku_id FROM gamen_koumoku_seigyo_tmp);
DROP TABLE gamen_koumoku_seigyo_tmp;

-- 画面権限制御の追加
DELETE from gamen_kengen_seigyo;
\copy gamen_kengen_seigyo FROM '.\files\csv\gamen_kengen_seigyo.csv' WITH CSV header ENCODING 'SHIFT-JIS';

-- 設定情報データ変更
CREATE TABLE setting_info_tmp AS SELECT * FROM setting_info;
DELETE FROM setting_info WHERE hyouji_jun < 900;
\copy setting_info FROM '.\files\csv\setting_info_tmp.csv' WITH CSV header ENCODING 'SHIFT-JIS';
UPDATE setting_info new SET setting_val = (
 SELECT setting_val
 FROM setting_info_tmp tmp
 WHERE tmp.setting_name = new.setting_name
) WHERE new.setting_name IN (
 SELECT setting_name FROM setting_info_tmp
);
DROP TABLE setting_info_tmp;

-- 伝票種別一覧データ変更
CREATE TABLE denpyou_shubetsu_ichiran_tmp AS SELECT * FROM denpyou_shubetsu_ichiran;
DELETE FROM denpyou_shubetsu_ichiran_tmp WHERE denpyou_kbn LIKE 'A%';
\copy denpyou_shubetsu_ichiran_tmp FROM '.\files\csv\denpyou_shubetsu_ichiran.csv' WITH CSV header ENCODING 'SHIFT-JIS';
UPDATE denpyou_shubetsu_ichiran SET hyouji_jun = hyouji_jun + 2 WHERE hyouji_jun > (SELECT hyouji_jun FROM denpyou_shubetsu_ichiran WHERE denpyou_kbn = 'A005');
INSERT INTO denpyou_shubetsu_ichiran (select * from denpyou_shubetsu_ichiran_tmp WHERE denpyou_kbn = 'A011');
INSERT INTO denpyou_shubetsu_ichiran (select * from denpyou_shubetsu_ichiran_tmp WHERE denpyou_kbn = 'A012');
UPDATE denpyou_shubetsu_ichiran SET hyouji_jun = (SELECT hyouji_jun FROM denpyou_shubetsu_ichiran WHERE denpyou_kbn = 'A005') + 1 WHERE denpyou_kbn = 'A011';
UPDATE denpyou_shubetsu_ichiran SET hyouji_jun = (SELECT hyouji_jun FROM denpyou_shubetsu_ichiran WHERE denpyou_kbn = 'A005') + 2 WHERE denpyou_kbn = 'A012';
DROP TABLE denpyou_shubetsu_ichiran_tmp;

-- 内部コード追加(部品形式)※TODO:naibu_cd_settingはオプション分があるから全入れ替えしちゃまずい
CREATE TABLE naibu_cd_setting_tmp AS SELECT * FROM naibu_cd_setting;
DELETE FROM naibu_cd_setting;
\copy naibu_cd_setting FROM '.\files\csv\naibu_cd_setting.csv' WITH CSV header ENCODING 'SHIFT-JIS';
DELETE FROM naibu_cd_setting WHERE naibu_cd='A003' AND (SELECT COUNT(*) FROM naibu_cd_setting_tmp WHERE naibu_cd='A003')=0;

-- 機能制御のデータ追加
\copy kinou_seigyo FROM '.\files\csv\kinou_seigyo_patch.csv' WITH CSV header ENCODING 'SHIFT-JIS';

-- 機能制御データ追加(初期値はRHの値を引き継ぐ)
insert into KINOU_SEIGYO values ( 'RR' , (select kinou_seigyo_kbn from kinou_seigyo where kinou_seigyo_cd = 'RH') );
insert into KINOU_SEIGYO values ( 'RA' , (select kinou_seigyo_kbn from kinou_seigyo where kinou_seigyo_cd = 'RH') );

-- 仕訳パターン設定データ変更
DELETE FROM shiwake_pattern_setting;
\copy shiwake_pattern_setting FROM '.\files\csv\shiwake_pattern_setting.csv' WITH CSV header ENCODING 'SHIFT-JIS';

-- 経費立替精算に会社手配合計のカラムを追加
ALTER TABLE KEIHISEISAN RENAME TO KEIHISEISAN_OLD;
CREATE TABLE KEIHISEISAN
(
	DENPYOU_ID VARCHAR(19) NOT NULL,
	KARIBARAI_DENPYOU_ID VARCHAR(19) NOT NULL,
	KARIBARAI_MISHIYOU_FLG VARCHAR(1) DEFAULT '0' NOT NULL,
	DAIRIFLG VARCHAR(1) DEFAULT '0' NOT NULL,
	KEIJOUBI DATE,
	SHIHARAIBI DATE,
	SHIHARAIKIBOUBI DATE,
	SHIHARAIHOUHOU VARCHAR(1) NOT NULL,
	HONTAI_KINGAKU_GOUKEI DECIMAL(15) NOT NULL,
	SHOUHIZEIGAKU_GOUKEI DECIMAL(15) NOT NULL,
	SHIHARAI_KINGAKU_GOUKEI DECIMAL(15) NOT NULL,
	HOUJIN_CARD_RIYOU_KINGAKU DECIMAL(15) NOT NULL,
	KAISHA_TEHAI_KINGAKU DECIMAL(15) NOT NULL,
	SASHIHIKI_SHIKYUU_KINGAKU DECIMAL(15) NOT NULL,
	HF1_CD VARCHAR(20) NOT NULL,
	HF1_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	HF2_CD VARCHAR(20) NOT NULL,
	HF2_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	HF3_CD VARCHAR(20) NOT NULL,
	HF3_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	HOSOKU VARCHAR(240) NOT NULL,
	TOUROKU_USER_ID VARCHAR(30) NOT NULL,
	TOUROKU_TIME TIMESTAMP NOT NULL,
	KOUSHIN_USER_ID VARCHAR(30) NOT NULL,
	KOUSHIN_TIME TIMESTAMP NOT NULL,
	PRIMARY KEY (DENPYOU_ID)
) WITHOUT OIDS;
COMMENT ON TABLE KEIHISEISAN IS '経費精算';
COMMENT ON COLUMN KEIHISEISAN.DENPYOU_ID IS '伝票ID';
COMMENT ON COLUMN KEIHISEISAN.KARIBARAI_DENPYOU_ID IS '仮払伝票ID';
COMMENT ON COLUMN KEIHISEISAN.KARIBARAI_MISHIYOU_FLG IS '仮払金未使用フラグ';
COMMENT ON COLUMN KEIHISEISAN.DAIRIFLG IS '代理フラグ';
COMMENT ON COLUMN KEIHISEISAN.KEIJOUBI IS '計上日';
COMMENT ON COLUMN KEIHISEISAN.SHIHARAIBI IS '支払日';
COMMENT ON COLUMN KEIHISEISAN.SHIHARAIKIBOUBI IS '支払希望日';
COMMENT ON COLUMN KEIHISEISAN.SHIHARAIHOUHOU IS '支払方法';
COMMENT ON COLUMN KEIHISEISAN.HONTAI_KINGAKU_GOUKEI IS '本体金額合計';
COMMENT ON COLUMN KEIHISEISAN.SHOUHIZEIGAKU_GOUKEI IS '消費税額合計';
COMMENT ON COLUMN KEIHISEISAN.SHIHARAI_KINGAKU_GOUKEI IS '支払金額合計';
COMMENT ON COLUMN KEIHISEISAN.HOUJIN_CARD_RIYOU_KINGAKU IS '内法人カード利用合計';
COMMENT ON COLUMN KEIHISEISAN.KAISHA_TEHAI_KINGAKU IS '会社手配合計';
COMMENT ON COLUMN KEIHISEISAN.SASHIHIKI_SHIKYUU_KINGAKU IS '差引支給金額';
COMMENT ON COLUMN KEIHISEISAN.HF1_CD IS 'HF1コード';
COMMENT ON COLUMN KEIHISEISAN.HF1_NAME_RYAKUSHIKI IS 'HF1名（略式）';
COMMENT ON COLUMN KEIHISEISAN.HF2_CD IS 'HF2コード';
COMMENT ON COLUMN KEIHISEISAN.HF2_NAME_RYAKUSHIKI IS 'HF2名（略式）';
COMMENT ON COLUMN KEIHISEISAN.HF3_CD IS 'HF3コード';
COMMENT ON COLUMN KEIHISEISAN.HF3_NAME_RYAKUSHIKI IS 'HF3名（略式）';
COMMENT ON COLUMN KEIHISEISAN.HOSOKU IS '補足';
COMMENT ON COLUMN KEIHISEISAN.TOUROKU_USER_ID IS '登録ユーザーID';
COMMENT ON COLUMN KEIHISEISAN.TOUROKU_TIME IS '登録日時';
COMMENT ON COLUMN KEIHISEISAN.KOUSHIN_USER_ID IS '更新ユーザーID';
COMMENT ON COLUMN KEIHISEISAN.KOUSHIN_TIME IS '更新日時';
INSERT
INTO KEIHISEISAN(
	DENPYOU_ID,
	KARIBARAI_DENPYOU_ID,
	KARIBARAI_MISHIYOU_FLG,
	DAIRIFLG,
	KEIJOUBI,
	SHIHARAIBI,
	SHIHARAIKIBOUBI,
	SHIHARAIHOUHOU,
	HONTAI_KINGAKU_GOUKEI,
	SHOUHIZEIGAKU_GOUKEI,
	SHIHARAI_KINGAKU_GOUKEI,
	HOUJIN_CARD_RIYOU_KINGAKU,
	KAISHA_TEHAI_KINGAKU,
	SASHIHIKI_SHIKYUU_KINGAKU,
	HF1_CD,
	HF1_NAME_RYAKUSHIKI,
	HF2_CD,
	HF2_NAME_RYAKUSHIKI,
	HF3_CD,
	HF3_NAME_RYAKUSHIKI,
	HOSOKU,
	TOUROKU_USER_ID,
	TOUROKU_TIME,
	KOUSHIN_USER_ID,
	KOUSHIN_TIME
)
SELECT
	DENPYOU_ID,
	KARIBARAI_DENPYOU_ID,
	KARIBARAI_MISHIYOU_FLG,
	DAIRIFLG,
	KEIJOUBI,
	SHIHARAIBI,
	SHIHARAIKIBOUBI,
	SHIHARAIHOUHOU,
	HONTAI_KINGAKU_GOUKEI,
	SHOUHIZEIGAKU_GOUKEI,
	SHIHARAI_KINGAKU_GOUKEI,
	HOUJIN_CARD_RIYOU_KINGAKU,
	0,
	SASHIHIKI_SHIKYUU_KINGAKU,
	HF1_CD,
	HF1_NAME_RYAKUSHIKI,
	HF2_CD,
	HF2_NAME_RYAKUSHIKI,
	HF3_CD,
	HF3_NAME_RYAKUSHIKI,
	HOSOKU,
	TOUROKU_USER_ID,
	TOUROKU_TIME,
	KOUSHIN_USER_ID,
	KOUSHIN_TIME
FROM KEIHISEISAN_OLD;

DROP TABLE KEIHISEISAN_OLD;

-- 経費精算明細に会社手配フラグを追加
ALTER TABLE KEIHISEISAN_MEISAI RENAME TO KEIHISEISAN_MEISAI_OLD;
CREATE TABLE KEIHISEISAN_MEISAI
(
	DENPYOU_ID VARCHAR(19) NOT NULL,
	DENPYOU_EDANO INT NOT NULL,
	SHIWAKE_EDANO INT NOT NULL,
	USER_ID VARCHAR(30) NOT NULL,
	SHAIN_NO VARCHAR(15) NOT NULL,
	USER_SEI VARCHAR(10) NOT NULL,
	USER_MEI VARCHAR(10) NOT NULL,
	SHIYOUBI DATE,
	SHOUHYOU_SHORUI_FLG VARCHAR(1),
	TORIHIKI_NAME VARCHAR(20) NOT NULL,
	TEKIYOU VARCHAR(60) NOT NULL,
	ZEIRITSU DECIMAL(3) NOT NULL,
	SHIHARAI_KINGAKU DECIMAL(15) NOT NULL,
	HONTAI_KINGAKU DECIMAL(15),
	SHOUHIZEIGAKU DECIMAL(15),
	HOUJIN_CARD_RIYOU_FLG VARCHAR(1) NOT NULL,
	KAISHA_TEHAI_FLG VARCHAR(1) NOT NULL,
	KOUSAIHI_SHOUSAI_HYOUJI_FLG VARCHAR(1) NOT NULL,
	KOUSAIHI_SHOUSAI VARCHAR(240),
	KARI_FUTAN_BUMON_CD VARCHAR(8) NOT NULL,
	KARI_FUTAN_BUMON_NAME VARCHAR(20) NOT NULL,
	TORIHIKISAKI_CD VARCHAR(12) NOT NULL,
	TORIHIKISAKI_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	KARI_KAMOKU_CD VARCHAR(6) NOT NULL,
	KARI_KAMOKU_NAME VARCHAR(22) NOT NULL,
	KARI_KAMOKU_EDABAN_CD VARCHAR(12) NOT NULL,
	KARI_KAMOKU_EDABAN_NAME VARCHAR(20) NOT NULL,
	KARI_KAZEI_KBN VARCHAR(3) NOT NULL,
	KASHI_FUTAN_BUMON_CD VARCHAR(8) NOT NULL,
	KASHI_FUTAN_BUMON_NAME VARCHAR(20) NOT NULL,
	KASHI_KAMOKU_CD VARCHAR(6) NOT NULL,
	KASHI_KAMOKU_NAME VARCHAR(22) NOT NULL,
	KASHI_KAMOKU_EDABAN_CD VARCHAR(12) NOT NULL,
	KASHI_KAMOKU_EDABAN_NAME VARCHAR(20) NOT NULL,
	KASHI_KAZEI_KBN VARCHAR(3) NOT NULL,
	UF1_CD VARCHAR(20) NOT NULL,
	UF1_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	UF2_CD VARCHAR(20) NOT NULL,
	UF2_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	UF3_CD VARCHAR(20) NOT NULL,
	UF3_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	PROJECT_CD VARCHAR(12) NOT NULL,
	PROJECT_NAME VARCHAR(20) NOT NULL,
	TEKIYOU_CD VARCHAR(4) NOT NULL,
	TOUROKU_USER_ID VARCHAR(30) NOT NULL,
	TOUROKU_TIME TIMESTAMP NOT NULL,
	KOUSHIN_USER_ID VARCHAR(30) NOT NULL,
	KOUSHIN_TIME TIMESTAMP NOT NULL,
	PRIMARY KEY (DENPYOU_ID, DENPYOU_EDANO)
) WITHOUT OIDS;
COMMENT ON TABLE KEIHISEISAN_MEISAI IS '経費精算明細';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.DENPYOU_ID IS '伝票ID';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.DENPYOU_EDANO IS '伝票枝番号';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.SHIWAKE_EDANO IS '仕訳枝番号';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.USER_ID IS 'ユーザーID';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.SHAIN_NO IS '社員番号';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.USER_SEI IS 'ユーザー姓';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.USER_MEI IS 'ユーザー名';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.SHIYOUBI IS '使用日';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.SHOUHYOU_SHORUI_FLG IS '証憑書類フラグ';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.TORIHIKI_NAME IS '取引名';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.TEKIYOU IS '摘要';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.ZEIRITSU IS '税率';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.SHIHARAI_KINGAKU IS '支払金額';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.HONTAI_KINGAKU IS '本体金額';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.SHOUHIZEIGAKU IS '消費税額';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.HOUJIN_CARD_RIYOU_FLG IS '法人カード利用フラグ';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.KAISHA_TEHAI_FLG IS '会社手配フラグ';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.KOUSAIHI_SHOUSAI_HYOUJI_FLG IS '交際費詳細表示フラグ';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.KOUSAIHI_SHOUSAI IS '交際費詳細';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.KARI_FUTAN_BUMON_CD IS '借方負担部門コード';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.KARI_FUTAN_BUMON_NAME IS '借方負担部門名';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.TORIHIKISAKI_CD IS '取引先コード';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.TORIHIKISAKI_NAME_RYAKUSHIKI IS '取引先名（略式）';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.KARI_KAMOKU_CD IS '借方科目コード';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.KARI_KAMOKU_NAME IS '借方科目名';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.KARI_KAMOKU_EDABAN_CD IS '借方科目枝番コード';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.KARI_KAMOKU_EDABAN_NAME IS '借方科目枝番名';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.KARI_KAZEI_KBN IS '借方課税区分';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.KASHI_FUTAN_BUMON_CD IS '貸方負担部門コード';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.KASHI_FUTAN_BUMON_NAME IS '貸方負担部門名';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.KASHI_KAMOKU_CD IS '貸方科目コード';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.KASHI_KAMOKU_NAME IS '貸方科目名';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.KASHI_KAMOKU_EDABAN_CD IS '貸方科目枝番コード';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.KASHI_KAMOKU_EDABAN_NAME IS '貸方科目枝番名';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.KASHI_KAZEI_KBN IS '貸方課税区分';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.UF1_CD IS 'UF1コード';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.UF1_NAME_RYAKUSHIKI IS 'UF1名（略式）';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.UF2_CD IS 'UF2コード';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.UF2_NAME_RYAKUSHIKI IS 'UF2名（略式）';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.UF3_CD IS 'UF3コード';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.UF3_NAME_RYAKUSHIKI IS 'UF3名（略式）';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.PROJECT_CD IS 'プロジェクトコード';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.PROJECT_NAME IS 'プロジェクト名';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.TEKIYOU_CD IS '摘要コード';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.TOUROKU_USER_ID IS '登録ユーザーID';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.TOUROKU_TIME IS '登録日時';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.KOUSHIN_USER_ID IS '更新ユーザーID';
COMMENT ON COLUMN KEIHISEISAN_MEISAI.KOUSHIN_TIME IS '更新日時';
INSERT
INTO KEIHISEISAN_MEISAI(
	DENPYOU_ID,
	DENPYOU_EDANO,
	SHIWAKE_EDANO,
	USER_ID,
	SHAIN_NO,
	USER_SEI,
	USER_MEI,
	SHIYOUBI,
	SHOUHYOU_SHORUI_FLG,
	TORIHIKI_NAME,
	TEKIYOU,
	ZEIRITSU,
	SHIHARAI_KINGAKU,
	HONTAI_KINGAKU,
	SHOUHIZEIGAKU,
	HOUJIN_CARD_RIYOU_FLG,
	KAISHA_TEHAI_FLG,
	KOUSAIHI_SHOUSAI_HYOUJI_FLG,
	KOUSAIHI_SHOUSAI,
	KARI_FUTAN_BUMON_CD,
	KARI_FUTAN_BUMON_NAME,
	TORIHIKISAKI_CD,
	TORIHIKISAKI_NAME_RYAKUSHIKI,
	KARI_KAMOKU_CD,
	KARI_KAMOKU_NAME,
	KARI_KAMOKU_EDABAN_CD,
	KARI_KAMOKU_EDABAN_NAME,
	KARI_KAZEI_KBN,
	KASHI_FUTAN_BUMON_CD,
	KASHI_FUTAN_BUMON_NAME,
	KASHI_KAMOKU_CD,
	KASHI_KAMOKU_NAME,
	KASHI_KAMOKU_EDABAN_CD,
	KASHI_KAMOKU_EDABAN_NAME,
	KASHI_KAZEI_KBN,
	UF1_CD,
	UF1_NAME_RYAKUSHIKI,
	UF2_CD,
	UF2_NAME_RYAKUSHIKI,
	UF3_CD,
	UF3_NAME_RYAKUSHIKI,
	PROJECT_CD,
	PROJECT_NAME,
	TEKIYOU_CD,
	TOUROKU_USER_ID,
	TOUROKU_TIME,
	KOUSHIN_USER_ID,
	KOUSHIN_TIME
)
SELECT
	DENPYOU_ID,
	DENPYOU_EDANO,
	SHIWAKE_EDANO,
	USER_ID,
	SHAIN_NO,
	USER_SEI,
	USER_MEI,
	SHIYOUBI,
	SHOUHYOU_SHORUI_FLG,
	TORIHIKI_NAME,
	TEKIYOU,
	ZEIRITSU,
	SHIHARAI_KINGAKU,
	HONTAI_KINGAKU,
	SHOUHIZEIGAKU,
	HOUJIN_CARD_RIYOU_FLG,
	'0',
	KOUSAIHI_SHOUSAI_HYOUJI_FLG,
	KOUSAIHI_SHOUSAI,
	KARI_FUTAN_BUMON_CD,
	KARI_FUTAN_BUMON_NAME,
	TORIHIKISAKI_CD,
	TORIHIKISAKI_NAME_RYAKUSHIKI,
	KARI_KAMOKU_CD,
	KARI_KAMOKU_NAME,
	KARI_KAMOKU_EDABAN_CD,
	KARI_KAMOKU_EDABAN_NAME,
	KARI_KAZEI_KBN,
	KASHI_FUTAN_BUMON_CD,
	KASHI_FUTAN_BUMON_NAME,
	KASHI_KAMOKU_CD,
	KASHI_KAMOKU_NAME,
	KASHI_KAMOKU_EDABAN_CD,
	KASHI_KAMOKU_EDABAN_NAME,
	KASHI_KAZEI_KBN,
	UF1_CD,
	UF1_NAME_RYAKUSHIKI,
	UF2_CD,
	UF2_NAME_RYAKUSHIKI,
	UF3_CD,
	UF3_NAME_RYAKUSHIKI,
	PROJECT_CD,
	PROJECT_NAME,
	TEKIYOU_CD,
	TOUROKU_USER_ID,
	TOUROKU_TIME,
	KOUSHIN_USER_ID,
	KOUSHIN_TIME
FROM KEIHISEISAN_MEISAI_OLD;

DROP TABLE KEIHISEISAN_MEISAI_OLD;

-- 旅費精算の修正（ユーザー姓名の追加・会社手配合計の追加）
ALTER TABLE RYOHISEISAN RENAME TO RYOHISEISAN_OLD;
CREATE TABLE RYOHISEISAN
(
	DENPYOU_ID VARCHAR(19) NOT NULL,
	KARIBARAI_DENPYOU_ID VARCHAR(19) NOT NULL,
	KARIBARAI_ON VARCHAR(1) NOT NULL,
	KARIBARAI_MISHIYOU_FLG VARCHAR(1) DEFAULT '0' NOT NULL,
	DAIRIFLG VARCHAR(1) NOT NULL,
	USER_ID VARCHAR(30) NOT NULL,
	SHAIN_NO VARCHAR(15) NOT NULL,
	USER_SEI VARCHAR(10) NOT NULL,
	USER_MEI VARCHAR(10) NOT NULL,
	HOUMONSAKI VARCHAR(120) NOT NULL,
	MOKUTEKI VARCHAR(240) NOT NULL,
	SEISANKIKAN_FROM DATE,
	SEISANKIKAN_FROM_HOUR VARCHAR(2),
	SEISANKIKAN_FROM_MIN VARCHAR(2),
	SEISANKIKAN_TO DATE,
	SEISANKIKAN_TO_HOUR VARCHAR(2),
	SEISANKIKAN_TO_MIN VARCHAR(2),
	KEIJOUBI DATE,
	SHIHARAIBI DATE,
	SHIHARAIKIBOUBI DATE,
	SHIHARAIHOUHOU VARCHAR(1) NOT NULL,
	TEKIYOU VARCHAR(60) NOT NULL,
	ZEIRITSU DECIMAL(3) NOT NULL,
	GOUKEI_KINGAKU DECIMAL(15) NOT NULL,
	HOUJIN_CARD_RIYOU_KINGAKU DECIMAL(15) NOT NULL,
	KAISHA_TEHAI_KINGAKU DECIMAL(15) NOT NULL,
	SASHIHIKI_SHIKYUU_KINGAKU DECIMAL(15) NOT NULL,
	HF1_CD VARCHAR(20) NOT NULL,
	HF1_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	HF2_CD VARCHAR(20) NOT NULL,
	HF2_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	HF3_CD VARCHAR(20) NOT NULL,
	HF3_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	HOSOKU VARCHAR(240) NOT NULL,
	SHIWAKE_EDANO INT,
	TORIHIKI_NAME VARCHAR(20) NOT NULL,
	KARI_FUTAN_BUMON_CD VARCHAR(8) NOT NULL,
	KARI_FUTAN_BUMON_NAME VARCHAR(20) NOT NULL,
	KARI_KAMOKU_CD VARCHAR(6) NOT NULL,
	KARI_KAMOKU_NAME VARCHAR(22) NOT NULL,
	KARI_KAMOKU_EDABAN_CD VARCHAR(12) NOT NULL,
	KARI_KAMOKU_EDABAN_NAME VARCHAR(20) NOT NULL,
	KARI_KAZEI_KBN VARCHAR(3) NOT NULL,
	KASHI_FUTAN_BUMON_CD VARCHAR(8) NOT NULL,
	KASHI_FUTAN_BUMON_NAME VARCHAR(20) NOT NULL,
	KASHI_KAMOKU_CD VARCHAR(6) NOT NULL,
	KASHI_KAMOKU_NAME VARCHAR(22) NOT NULL,
	KASHI_KAMOKU_EDABAN_CD VARCHAR(12) NOT NULL,
	KASHI_KAMOKU_EDABAN_NAME VARCHAR(20) NOT NULL,
	KASHI_KAZEI_KBN VARCHAR(3) NOT NULL,
	UF1_CD VARCHAR(20) NOT NULL,
	UF1_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	UF2_CD VARCHAR(20) NOT NULL,
	UF2_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	UF3_CD VARCHAR(20) NOT NULL,
	UF3_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	PROJECT_CD VARCHAR(12) NOT NULL,
	PROJECT_NAME VARCHAR(20) NOT NULL,
	TEKIYOU_CD VARCHAR(4) NOT NULL,
	TOUROKU_USER_ID VARCHAR(30) NOT NULL,
	TOUROKU_TIME TIMESTAMP NOT NULL,
	KOUSHIN_USER_ID VARCHAR(30) NOT NULL,
	KOUSHIN_TIME TIMESTAMP NOT NULL,
	PRIMARY KEY (DENPYOU_ID)
) WITHOUT OIDS;
COMMENT ON TABLE RYOHISEISAN IS '旅費精算';
COMMENT ON COLUMN RYOHISEISAN.DENPYOU_ID IS '伝票ID';
COMMENT ON COLUMN RYOHISEISAN.KARIBARAI_DENPYOU_ID IS '仮払伝票ID';
COMMENT ON COLUMN RYOHISEISAN.KARIBARAI_ON IS '仮払申請フラグ';
COMMENT ON COLUMN RYOHISEISAN.KARIBARAI_MISHIYOU_FLG IS '仮払金未使用フラグ';
COMMENT ON COLUMN RYOHISEISAN.DAIRIFLG IS '代理フラグ';
COMMENT ON COLUMN RYOHISEISAN.USER_ID IS 'ユーザーID';
COMMENT ON COLUMN RYOHISEISAN.SHAIN_NO IS '社員番号';
COMMENT ON COLUMN RYOHISEISAN.USER_SEI IS 'ユーザー姓';
COMMENT ON COLUMN RYOHISEISAN.USER_MEI IS 'ユーザー名';
COMMENT ON COLUMN RYOHISEISAN.HOUMONSAKI IS '訪問先';
COMMENT ON COLUMN RYOHISEISAN.MOKUTEKI IS '目的';
COMMENT ON COLUMN RYOHISEISAN.SEISANKIKAN_FROM IS '精算期間開始日';
COMMENT ON COLUMN RYOHISEISAN.SEISANKIKAN_FROM_HOUR IS '精算期間開始時刻（時）';
COMMENT ON COLUMN RYOHISEISAN.SEISANKIKAN_FROM_MIN IS '精算期間開始時刻（分）';
COMMENT ON COLUMN RYOHISEISAN.SEISANKIKAN_TO IS '精算期間終了日';
COMMENT ON COLUMN RYOHISEISAN.SEISANKIKAN_TO_HOUR IS '精算期間終了時刻（時）';
COMMENT ON COLUMN RYOHISEISAN.SEISANKIKAN_TO_MIN IS '精算期間終了時刻（分）';
COMMENT ON COLUMN RYOHISEISAN.KEIJOUBI IS '計上日';
COMMENT ON COLUMN RYOHISEISAN.SHIHARAIBI IS '支払日';
COMMENT ON COLUMN RYOHISEISAN.SHIHARAIKIBOUBI IS '支払希望日';
COMMENT ON COLUMN RYOHISEISAN.SHIHARAIHOUHOU IS '支払方法';
COMMENT ON COLUMN RYOHISEISAN.TEKIYOU IS '摘要';
COMMENT ON COLUMN RYOHISEISAN.ZEIRITSU IS '税率';
COMMENT ON COLUMN RYOHISEISAN.GOUKEI_KINGAKU IS '合計金額';
COMMENT ON COLUMN RYOHISEISAN.HOUJIN_CARD_RIYOU_KINGAKU IS '内法人カード利用合計';
COMMENT ON COLUMN RYOHISEISAN.KAISHA_TEHAI_KINGAKU IS '会社手配合計';
COMMENT ON COLUMN RYOHISEISAN.SASHIHIKI_SHIKYUU_KINGAKU IS '差引支給金額';
COMMENT ON COLUMN RYOHISEISAN.HF1_CD IS 'HF1コード';
COMMENT ON COLUMN RYOHISEISAN.HF1_NAME_RYAKUSHIKI IS 'HF1名（略式）';
COMMENT ON COLUMN RYOHISEISAN.HF2_CD IS 'HF2コード';
COMMENT ON COLUMN RYOHISEISAN.HF2_NAME_RYAKUSHIKI IS 'HF2名（略式）';
COMMENT ON COLUMN RYOHISEISAN.HF3_CD IS 'HF3コード';
COMMENT ON COLUMN RYOHISEISAN.HF3_NAME_RYAKUSHIKI IS 'HF3名（略式）';
COMMENT ON COLUMN RYOHISEISAN.HOSOKU IS '補足';
COMMENT ON COLUMN RYOHISEISAN.SHIWAKE_EDANO IS '仕訳枝番号';
COMMENT ON COLUMN RYOHISEISAN.TORIHIKI_NAME IS '取引名';
COMMENT ON COLUMN RYOHISEISAN.KARI_FUTAN_BUMON_CD IS '借方負担部門コード';
COMMENT ON COLUMN RYOHISEISAN.KARI_FUTAN_BUMON_NAME IS '借方負担部門名';
COMMENT ON COLUMN RYOHISEISAN.KARI_KAMOKU_CD IS '借方科目コード';
COMMENT ON COLUMN RYOHISEISAN.KARI_KAMOKU_NAME IS '借方科目名';
COMMENT ON COLUMN RYOHISEISAN.KARI_KAMOKU_EDABAN_CD IS '借方科目枝番コード';
COMMENT ON COLUMN RYOHISEISAN.KARI_KAMOKU_EDABAN_NAME IS '借方科目枝番名';
COMMENT ON COLUMN RYOHISEISAN.KARI_KAZEI_KBN IS '借方課税区分';
COMMENT ON COLUMN RYOHISEISAN.KASHI_FUTAN_BUMON_CD IS '貸方負担部門コード';
COMMENT ON COLUMN RYOHISEISAN.KASHI_FUTAN_BUMON_NAME IS '貸方負担部門名';
COMMENT ON COLUMN RYOHISEISAN.KASHI_KAMOKU_CD IS '貸方科目コード';
COMMENT ON COLUMN RYOHISEISAN.KASHI_KAMOKU_NAME IS '貸方科目名';
COMMENT ON COLUMN RYOHISEISAN.KASHI_KAMOKU_EDABAN_CD IS '貸方科目枝番コード';
COMMENT ON COLUMN RYOHISEISAN.KASHI_KAMOKU_EDABAN_NAME IS '貸方科目枝番名';
COMMENT ON COLUMN RYOHISEISAN.KASHI_KAZEI_KBN IS '貸方課税区分';
COMMENT ON COLUMN RYOHISEISAN.UF1_CD IS 'UF1コード';
COMMENT ON COLUMN RYOHISEISAN.UF1_NAME_RYAKUSHIKI IS 'UF1名（略式）';
COMMENT ON COLUMN RYOHISEISAN.UF2_CD IS 'UF2コード';
COMMENT ON COLUMN RYOHISEISAN.UF2_NAME_RYAKUSHIKI IS 'UF2名（略式）';
COMMENT ON COLUMN RYOHISEISAN.UF3_CD IS 'UF3コード';
COMMENT ON COLUMN RYOHISEISAN.UF3_NAME_RYAKUSHIKI IS 'UF3名（略式）';
COMMENT ON COLUMN RYOHISEISAN.PROJECT_CD IS 'プロジェクトコード';
COMMENT ON COLUMN RYOHISEISAN.PROJECT_NAME IS 'プロジェクト名';
COMMENT ON COLUMN RYOHISEISAN.TEKIYOU_CD IS '摘要コード';
COMMENT ON COLUMN RYOHISEISAN.TOUROKU_USER_ID IS '登録ユーザーID';
COMMENT ON COLUMN RYOHISEISAN.TOUROKU_TIME IS '登録日時';
COMMENT ON COLUMN RYOHISEISAN.KOUSHIN_USER_ID IS '更新ユーザーID';
COMMENT ON COLUMN RYOHISEISAN.KOUSHIN_TIME IS '更新日時';

INSERT
INTO RYOHISEISAN(
	DENPYOU_ID,
	KARIBARAI_DENPYOU_ID,
	KARIBARAI_ON,
	KARIBARAI_MISHIYOU_FLG,
	DAIRIFLG,
	USER_ID,
	SHAIN_NO,
	USER_SEI,
	USER_MEI,
	HOUMONSAKI,
	MOKUTEKI,
	SEISANKIKAN_FROM,
	SEISANKIKAN_FROM_HOUR,
	SEISANKIKAN_FROM_MIN,
	SEISANKIKAN_TO,
	SEISANKIKAN_TO_HOUR,
	SEISANKIKAN_TO_MIN,
	KEIJOUBI,
	SHIHARAIBI,
	SHIHARAIKIBOUBI,
	SHIHARAIHOUHOU,
	TEKIYOU,
	ZEIRITSU,
	GOUKEI_KINGAKU,
	HOUJIN_CARD_RIYOU_KINGAKU,
	KAISHA_TEHAI_KINGAKU,
	SASHIHIKI_SHIKYUU_KINGAKU,
	HF1_CD,
	HF1_NAME_RYAKUSHIKI,
	HF2_CD,
	HF2_NAME_RYAKUSHIKI,
	HF3_CD,
	HF3_NAME_RYAKUSHIKI,
	HOSOKU,
	SHIWAKE_EDANO,
	TORIHIKI_NAME,
	KARI_FUTAN_BUMON_CD,
	KARI_FUTAN_BUMON_NAME,
	KARI_KAMOKU_CD,
	KARI_KAMOKU_NAME,
	KARI_KAMOKU_EDABAN_CD,
	KARI_KAMOKU_EDABAN_NAME,
	KARI_KAZEI_KBN,
	KASHI_FUTAN_BUMON_CD,
	KASHI_FUTAN_BUMON_NAME,
	KASHI_KAMOKU_CD,
	KASHI_KAMOKU_NAME,
	KASHI_KAMOKU_EDABAN_CD,
	KASHI_KAMOKU_EDABAN_NAME,
	KASHI_KAZEI_KBN,
	UF1_CD,
	UF1_NAME_RYAKUSHIKI,
	UF2_CD,
	UF2_NAME_RYAKUSHIKI,
	UF3_CD,
	UF3_NAME_RYAKUSHIKI,
	PROJECT_CD,
	PROJECT_NAME,
	TEKIYOU_CD,
	TOUROKU_USER_ID,
	TOUROKU_TIME,
	KOUSHIN_USER_ID,
	KOUSHIN_TIME
)
SELECT 
	r.DENPYOU_ID,
	r.KARIBARAI_DENPYOU_ID,
	r.KARIBARAI_ON,
	r.KARIBARAI_MISHIYOU_FLG,
	'0',
	s.USER_ID,
	COALESCE(u.SHAIN_NO,''),
	substring(USER_FULL_NAME, 0 , position('　' in USER_FULL_NAME)) as USER_SEI,
	substring(USER_FULL_NAME, position('　' in USER_FULL_NAME) + 1, CASE WHEN position('(' in USER_FULL_NAME) <> 0 THEN (position('(' in USER_FULL_NAME) - position('　' in USER_FULL_NAME) - 1) ELSE length(USER_FULL_NAME) END) as USER_MEI,
	r.HOUMONSAKI,
	r.MOKUTEKI,
	r.SEISANKIKAN_FROM,
	r.SEISANKIKAN_FROM_HOUR,
	r.SEISANKIKAN_FROM_MIN,
	r.SEISANKIKAN_TO,
	r.SEISANKIKAN_TO_HOUR,
	r.SEISANKIKAN_TO_MIN,
	r.KEIJOUBI,
	r.SHIHARAIBI,
	r.SHIHARAIKIBOUBI,
	r.SHIHARAIHOUHOU,
	r.TEKIYOU,
	r.ZEIRITSU,
	r.GOUKEI_KINGAKU,
	r.HOUJIN_CARD_RIYOU_KINGAKU,
	0,
	r.SASHIHIKI_SHIKYUU_KINGAKU,
	r.HF1_CD,
	r.HF1_NAME_RYAKUSHIKI,
	r.HF2_CD,
	r.HF2_NAME_RYAKUSHIKI,
	r.HF3_CD,
	r.HF3_NAME_RYAKUSHIKI,
	r.HOSOKU,
	r.SHIWAKE_EDANO,
	r.TORIHIKI_NAME,
	r.KARI_FUTAN_BUMON_CD,
	r.KARI_FUTAN_BUMON_NAME,
	r.KARI_KAMOKU_CD,
	r.KARI_KAMOKU_NAME,
	r.KARI_KAMOKU_EDABAN_CD,
	r.KARI_KAMOKU_EDABAN_NAME,
	r.KARI_KAZEI_KBN,
	r.KASHI_FUTAN_BUMON_CD,
	r.KASHI_FUTAN_BUMON_NAME,
	r.KASHI_KAMOKU_CD,
	r.KASHI_KAMOKU_NAME,
	r.KASHI_KAMOKU_EDABAN_CD,
	r.KASHI_KAMOKU_EDABAN_NAME,
	r.KASHI_KAZEI_KBN,
	r.UF1_CD,
	r.UF1_NAME_RYAKUSHIKI,
	r.UF2_CD,
	r.UF2_NAME_RYAKUSHIKI,
	r.UF3_CD,
	r.UF3_NAME_RYAKUSHIKI,
	r.PROJECT_CD,
	r.PROJECT_NAME,
	r.TEKIYOU_CD,
	r.TOUROKU_USER_ID,
	r.TOUROKU_TIME,
	r.KOUSHIN_USER_ID,
	r.KOUSHIN_TIME
FROM (RYOHISEISAN_OLD r INNER JOIN SHOUNIN_ROUTE s ON r.denpyou_id = s.denpyou_id AND edano = 1)
LEFT OUTER JOIN USER_INFO u ON s.user_id = u.user_id;

DROP TABLE RYOHISEISAN_OLD;

-- 旅費精算明細に会社手配フラグを追加
ALTER TABLE RYOHISEISAN_MEISAI RENAME TO RYOHISEISAN_MEISAI_OLD;
CREATE TABLE RYOHISEISAN_MEISAI
(
	DENPYOU_ID VARCHAR(19) NOT NULL,
	DENPYOU_EDANO INT NOT NULL,
	KIKAN_FROM DATE NOT NULL,
	KIKAN_TO DATE,
	KYUUJITSU_NISSUU NUMERIC,
	SHUBETSU_CD VARCHAR(1) NOT NULL,
	SHUBETSU1 VARCHAR(20) NOT NULL,
	SHUBETSU2 VARCHAR(20) NOT NULL,
	KOUTSUU_SHUDAN VARCHAR(10) NOT NULL,
	SHOUHYOU_SHORUI_HISSU_FLG VARCHAR(1) NOT NULL,
	RYOUSHUUSHO_SEIKYUUSHO_TOU_FLG CHAR(1) NOT NULL,
	NAIYOU VARCHAR(512) NOT NULL,
	BIKOU VARCHAR(200) NOT NULL,
	OUFUKU_FLG VARCHAR(1) NOT NULL,
	HOUJIN_CARD_RIYOU_FLG VARCHAR(1) NOT NULL,
	KAISHA_TEHAI_FLG VARCHAR(1) NOT NULL,
	JIDOUNYUURYOKU_FLG VARCHAR(1) NOT NULL,
	NISSUU NUMERIC,
	TANKA DECIMAL(15) NOT NULL,
	MEISAI_KINGAKU DECIMAL(15) NOT NULL,
	TOUROKU_USER_ID VARCHAR(30) NOT NULL,
	TOUROKU_TIME TIMESTAMP NOT NULL,
	KOUSHIN_USER_ID VARCHAR(30) NOT NULL,
	KOUSHIN_TIME TIMESTAMP NOT NULL,
	PRIMARY KEY (DENPYOU_ID, DENPYOU_EDANO)
) WITHOUT OIDS;
COMMENT ON TABLE RYOHISEISAN_MEISAI IS '旅費精算明細';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.DENPYOU_ID IS '伝票ID';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.DENPYOU_EDANO IS '伝票枝番号';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.KIKAN_FROM IS '期間開始日';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.KIKAN_TO IS '期間終了日';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.KYUUJITSU_NISSUU IS '休日日数';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.SHUBETSU_CD IS '種別コード';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.SHUBETSU1 IS '種別１';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.SHUBETSU2 IS '種別２';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.KOUTSUU_SHUDAN IS '交通手段';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.SHOUHYOU_SHORUI_HISSU_FLG IS '証憑書類必須フラグ';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.RYOUSHUUSHO_SEIKYUUSHO_TOU_FLG IS '領収書・請求書等フラグ';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.NAIYOU IS '内容（旅費精算）';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.BIKOU IS '備考（旅費精算）';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.OUFUKU_FLG IS '往復フラグ';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.HOUJIN_CARD_RIYOU_FLG IS '法人カード利用フラグ';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.KAISHA_TEHAI_FLG IS '会社手配フラグ';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.JIDOUNYUURYOKU_FLG IS '自動入力フラグ';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.NISSUU IS '日数';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.TANKA IS '単価';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.MEISAI_KINGAKU IS '明細金額';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.TOUROKU_USER_ID IS '登録ユーザーID';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.TOUROKU_TIME IS '登録日時';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.KOUSHIN_USER_ID IS '更新ユーザーID';
COMMENT ON COLUMN RYOHISEISAN_MEISAI.KOUSHIN_TIME IS '更新日時';
INSERT
INTO RYOHISEISAN_MEISAI(
	DENPYOU_ID,
	DENPYOU_EDANO,
	KIKAN_FROM,
	KIKAN_TO,
	KYUUJITSU_NISSUU,
	SHUBETSU_CD,
	SHUBETSU1,
	SHUBETSU2,
	KOUTSUU_SHUDAN,
	SHOUHYOU_SHORUI_HISSU_FLG,
	RYOUSHUUSHO_SEIKYUUSHO_TOU_FLG,
	NAIYOU,
	BIKOU,
	OUFUKU_FLG,
	HOUJIN_CARD_RIYOU_FLG,
	KAISHA_TEHAI_FLG,
	JIDOUNYUURYOKU_FLG,
	NISSUU,
	TANKA,
	MEISAI_KINGAKU,
	TOUROKU_USER_ID,
	TOUROKU_TIME,
	KOUSHIN_USER_ID,
	KOUSHIN_TIME
)
SELECT 
	DENPYOU_ID,
	DENPYOU_EDANO,
	KIKAN_FROM,
	KIKAN_TO,
	KYUUJITSU_NISSUU,
	SHUBETSU_CD,
	SHUBETSU1,
	SHUBETSU2,
	KOUTSUU_SHUDAN,
	SHOUHYOU_SHORUI_HISSU_FLG,
	RYOUSHUUSHO_SEIKYUUSHO_TOU_FLG,
	NAIYOU,
	BIKOU,
	OUFUKU_FLG,
	HOUJIN_CARD_RIYOU_FLG,
	'0',
	JIDOUNYUURYOKU_FLG,
	NISSUU,
	TANKA,
	MEISAI_KINGAKU,
	TOUROKU_USER_ID,
	TOUROKU_TIME,
	KOUSHIN_USER_ID,
	KOUSHIN_TIME
FROM RYOHISEISAN_MEISAI_OLD;

DROP TABLE RYOHISEISAN_MEISAI_OLD;

-- 旅費精算経費明細（ユーザー姓名の削除）
ALTER TABLE RYOHISEISAN_KEIHI_MEISAI RENAME TO RYOHISEISAN_KEIHI_MEISAI_OLD;
CREATE TABLE RYOHISEISAN_KEIHI_MEISAI
(
	DENPYOU_ID VARCHAR(19) NOT NULL,
	DENPYOU_EDANO INT NOT NULL,
	SHIWAKE_EDANO INT NOT NULL,
	SHIYOUBI DATE,
	SHOUHYOU_SHORUI_FLG VARCHAR(1),
	TORIHIKI_NAME VARCHAR(20) NOT NULL,
	TEKIYOU VARCHAR(60) NOT NULL,
	ZEIRITSU DECIMAL(3) NOT NULL,
	SHIHARAI_KINGAKU DECIMAL(15) NOT NULL,
	HONTAI_KINGAKU DECIMAL(15),
	SHOUHIZEIGAKU DECIMAL(15),
	HOUJIN_CARD_RIYOU_FLG VARCHAR(1) NOT NULL,
	KAISHA_TEHAI_FLG VARCHAR(1) NOT NULL,
	KOUSAIHI_SHOUSAI_HYOUJI_FLG VARCHAR(1) NOT NULL,
	KOUSAIHI_SHOUSAI VARCHAR(240),
	KARI_FUTAN_BUMON_CD VARCHAR(8) NOT NULL,
	KARI_FUTAN_BUMON_NAME VARCHAR(20) NOT NULL,
	TORIHIKISAKI_CD VARCHAR(12) NOT NULL,
	TORIHIKISAKI_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	KARI_KAMOKU_CD VARCHAR(6) NOT NULL,
	KARI_KAMOKU_NAME VARCHAR(22) NOT NULL,
	KARI_KAMOKU_EDABAN_CD VARCHAR(12) NOT NULL,
	KARI_KAMOKU_EDABAN_NAME VARCHAR(20) NOT NULL,
	KARI_KAZEI_KBN VARCHAR(3) NOT NULL,
	KASHI_FUTAN_BUMON_CD VARCHAR(8) NOT NULL,
	KASHI_FUTAN_BUMON_NAME VARCHAR(20) NOT NULL,
	KASHI_KAMOKU_CD VARCHAR(6) NOT NULL,
	KASHI_KAMOKU_NAME VARCHAR(22) NOT NULL,
	KASHI_KAMOKU_EDABAN_CD VARCHAR(12) NOT NULL,
	KASHI_KAMOKU_EDABAN_NAME VARCHAR(20) NOT NULL,
	KASHI_KAZEI_KBN VARCHAR(3) NOT NULL,
	UF1_CD VARCHAR(20) NOT NULL,
	UF1_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	UF2_CD VARCHAR(20) NOT NULL,
	UF2_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	UF3_CD VARCHAR(20) NOT NULL,
	UF3_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	PROJECT_CD VARCHAR(12) NOT NULL,
	PROJECT_NAME VARCHAR(20) NOT NULL,
	TEKIYOU_CD VARCHAR(4) NOT NULL,
	TOUROKU_USER_ID VARCHAR(30) NOT NULL,
	TOUROKU_TIME TIMESTAMP NOT NULL,
	KOUSHIN_USER_ID VARCHAR(30) NOT NULL,
	KOUSHIN_TIME TIMESTAMP NOT NULL,
	PRIMARY KEY (DENPYOU_ID, DENPYOU_EDANO)
) WITHOUT OIDS;
COMMENT ON TABLE RYOHISEISAN_KEIHI_MEISAI IS '旅費精算経費明細';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.DENPYOU_ID IS '伝票ID';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.DENPYOU_EDANO IS '伝票枝番号';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.SHIWAKE_EDANO IS '仕訳枝番号';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.SHIYOUBI IS '使用日';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.SHOUHYOU_SHORUI_FLG IS '証憑書類フラグ';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.TORIHIKI_NAME IS '取引名';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.TEKIYOU IS '摘要';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.ZEIRITSU IS '税率';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.SHIHARAI_KINGAKU IS '支払金額';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.HONTAI_KINGAKU IS '本体金額';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.SHOUHIZEIGAKU IS '消費税額';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.HOUJIN_CARD_RIYOU_FLG IS '法人カード利用フラグ';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.KAISHA_TEHAI_FLG IS '会社手配フラグ';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.KOUSAIHI_SHOUSAI_HYOUJI_FLG IS '交際費詳細表示フラグ';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.KOUSAIHI_SHOUSAI IS '交際費詳細';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.KARI_FUTAN_BUMON_CD IS '借方負担部門コード';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.KARI_FUTAN_BUMON_NAME IS '借方負担部門名';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.TORIHIKISAKI_CD IS '取引先コード';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.TORIHIKISAKI_NAME_RYAKUSHIKI IS '取引先名（略式）';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.KARI_KAMOKU_CD IS '借方科目コード';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.KARI_KAMOKU_NAME IS '借方科目名';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.KARI_KAMOKU_EDABAN_CD IS '借方科目枝番コード';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.KARI_KAMOKU_EDABAN_NAME IS '借方科目枝番名';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.KARI_KAZEI_KBN IS '借方課税区分';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.KASHI_FUTAN_BUMON_CD IS '貸方負担部門コード';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.KASHI_FUTAN_BUMON_NAME IS '貸方負担部門名';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.KASHI_KAMOKU_CD IS '貸方科目コード';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.KASHI_KAMOKU_NAME IS '貸方科目名';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.KASHI_KAMOKU_EDABAN_CD IS '貸方科目枝番コード';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.KASHI_KAMOKU_EDABAN_NAME IS '貸方科目枝番名';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.KASHI_KAZEI_KBN IS '貸方課税区分';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.UF1_CD IS 'UF1コード';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.UF1_NAME_RYAKUSHIKI IS 'UF1名（略式）';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.UF2_CD IS 'UF2コード';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.UF2_NAME_RYAKUSHIKI IS 'UF2名（略式）';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.UF3_CD IS 'UF3コード';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.UF3_NAME_RYAKUSHIKI IS 'UF3名（略式）';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.PROJECT_CD IS 'プロジェクトコード';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.PROJECT_NAME IS 'プロジェクト名';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.TEKIYOU_CD IS '摘要コード';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.TOUROKU_USER_ID IS '登録ユーザーID';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.TOUROKU_TIME IS '登録日時';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.KOUSHIN_USER_ID IS '更新ユーザーID';
COMMENT ON COLUMN RYOHISEISAN_KEIHI_MEISAI.KOUSHIN_TIME IS '更新日時';

INSERT
INTO RYOHISEISAN_KEIHI_MEISAI(
	DENPYOU_ID,
	DENPYOU_EDANO,
	SHIWAKE_EDANO,
	SHIYOUBI,
	SHOUHYOU_SHORUI_FLG,
	TORIHIKI_NAME,
	TEKIYOU,
	ZEIRITSU,
	SHIHARAI_KINGAKU,
	HONTAI_KINGAKU,
	SHOUHIZEIGAKU,
	HOUJIN_CARD_RIYOU_FLG,
	KAISHA_TEHAI_FLG,
	KOUSAIHI_SHOUSAI_HYOUJI_FLG,
	KOUSAIHI_SHOUSAI,
	KARI_FUTAN_BUMON_CD,
	KARI_FUTAN_BUMON_NAME,
	TORIHIKISAKI_CD,
	TORIHIKISAKI_NAME_RYAKUSHIKI,
	KARI_KAMOKU_CD,
	KARI_KAMOKU_NAME,
	KARI_KAMOKU_EDABAN_CD,
	KARI_KAMOKU_EDABAN_NAME,
	KARI_KAZEI_KBN,
	KASHI_FUTAN_BUMON_CD,
	KASHI_FUTAN_BUMON_NAME,
	KASHI_KAMOKU_CD,
	KASHI_KAMOKU_NAME,
	KASHI_KAMOKU_EDABAN_CD,
	KASHI_KAMOKU_EDABAN_NAME,
	KASHI_KAZEI_KBN,
	UF1_CD,
	UF1_NAME_RYAKUSHIKI,
	UF2_CD,
	UF2_NAME_RYAKUSHIKI,
	UF3_CD,
	UF3_NAME_RYAKUSHIKI,
	PROJECT_CD,
	PROJECT_NAME,
	TEKIYOU_CD,
	TOUROKU_USER_ID,
	TOUROKU_TIME,
	KOUSHIN_USER_ID,
	KOUSHIN_TIME
)
SELECT 
	DENPYOU_ID,
	DENPYOU_EDANO,
	SHIWAKE_EDANO,
	SHIYOUBI,
	SHOUHYOU_SHORUI_FLG,
	TORIHIKI_NAME,
	TEKIYOU,
	ZEIRITSU,
	SHIHARAI_KINGAKU,
	HONTAI_KINGAKU,
	SHOUHIZEIGAKU,
	HOUJIN_CARD_RIYOU_FLG,
	'0',
	KOUSAIHI_SHOUSAI_HYOUJI_FLG,
	KOUSAIHI_SHOUSAI,
	KARI_FUTAN_BUMON_CD,
	KARI_FUTAN_BUMON_NAME,
	TORIHIKISAKI_CD,
	TORIHIKISAKI_NAME_RYAKUSHIKI,
	KARI_KAMOKU_CD,
	KARI_KAMOKU_NAME,
	KARI_KAMOKU_EDABAN_CD,
	KARI_KAMOKU_EDABAN_NAME,
	KARI_KAZEI_KBN,
	KASHI_FUTAN_BUMON_CD,
	KASHI_FUTAN_BUMON_NAME,
	KASHI_KAMOKU_CD,
	KASHI_KAMOKU_NAME,
	KASHI_KAMOKU_EDABAN_CD,
	KASHI_KAMOKU_EDABAN_NAME,
	KASHI_KAZEI_KBN,
	UF1_CD,
	UF1_NAME_RYAKUSHIKI,
	UF2_CD,
	UF2_NAME_RYAKUSHIKI,
	UF3_CD,
	UF3_NAME_RYAKUSHIKI,
	PROJECT_CD,
	PROJECT_NAME,
	TEKIYOU_CD,
	TOUROKU_USER_ID,
	TOUROKU_TIME,
	KOUSHIN_USER_ID,
	KOUSHIN_TIME
FROM RYOHISEISAN_KEIHI_MEISAI_OLD;

DROP TABLE RYOHISEISAN_KEIHI_MEISAI_OLD;

-- 旅費仮払の修正（ユーザー姓名を追加）
ALTER TABLE RYOHI_KARIBARAI RENAME TO RYOHI_KARIBARAI_OLD;
CREATE TABLE RYOHI_KARIBARAI
(
	DENPYOU_ID VARCHAR(19) NOT NULL,
	KARIBARAI_ON VARCHAR(1) DEFAULT '0' NOT NULL,
	DAIRIFLG VARCHAR(1) NOT NULL,
	USER_ID VARCHAR(30),
	SHAIN_NO VARCHAR(15) NOT NULL,
	USER_SEI VARCHAR(10) NOT NULL,
	USER_MEI VARCHAR(10) NOT NULL,
	HOUMONSAKI VARCHAR(120) NOT NULL,
	MOKUTEKI VARCHAR(240) NOT NULL,
	SEISANKIKAN_FROM DATE,
	SEISANKIKAN_FROM_HOUR VARCHAR(2),
	SEISANKIKAN_FROM_MIN VARCHAR(2),
	SEISANKIKAN_TO DATE,
	SEISANKIKAN_TO_HOUR VARCHAR(2),
	SEISANKIKAN_TO_MIN VARCHAR(2),
	SHIHARAIBI DATE,
	SHIHARAIKIBOUBI DATE,
	SHIHARAIHOUHOU VARCHAR(1) NOT NULL,
	TEKIYOU VARCHAR(60) NOT NULL,
	KINGAKU DECIMAL(15) NOT NULL,
	KARIBARAI_KINGAKU DECIMAL(15),
	HF1_CD VARCHAR(20) NOT NULL,
	HF1_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	HF2_CD VARCHAR(20) NOT NULL,
	HF2_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	HF3_CD VARCHAR(20) NOT NULL,
	HF3_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	HOSOKU VARCHAR(240) NOT NULL,
	SHIWAKE_EDANO INT,
	TORIHIKI_NAME VARCHAR(20) NOT NULL,
	KARI_FUTAN_BUMON_CD VARCHAR(8) NOT NULL,
	KARI_FUTAN_BUMON_NAME VARCHAR(20) NOT NULL,
	KARI_KAMOKU_CD VARCHAR(6) NOT NULL,
	KARI_KAMOKU_NAME VARCHAR(22) NOT NULL,
	KARI_KAMOKU_EDABAN_CD VARCHAR(12) NOT NULL,
	KARI_KAMOKU_EDABAN_NAME VARCHAR(20) NOT NULL,
	KARI_KAZEI_KBN VARCHAR(3) NOT NULL,
	KASHI_FUTAN_BUMON_CD VARCHAR(8) NOT NULL,
	KASHI_FUTAN_BUMON_NAME VARCHAR(20) NOT NULL,
	KASHI_KAMOKU_CD VARCHAR(6) NOT NULL,
	KASHI_KAMOKU_NAME VARCHAR(22) NOT NULL,
	KASHI_KAMOKU_EDABAN_CD VARCHAR(12) NOT NULL,
	KASHI_KAMOKU_EDABAN_NAME VARCHAR(20) NOT NULL,
	KASHI_KAZEI_KBN VARCHAR(3) NOT NULL,
	UF1_CD VARCHAR(20) NOT NULL,
	UF1_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	UF2_CD VARCHAR(20) NOT NULL,
	UF2_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	UF3_CD VARCHAR(20) NOT NULL,
	UF3_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	TEKIYOU_CD VARCHAR(4) NOT NULL,
	TOUROKU_USER_ID VARCHAR(30) NOT NULL,
	TOUROKU_TIME TIMESTAMP NOT NULL,
	KOUSHIN_USER_ID VARCHAR(30) NOT NULL,
	KOUSHIN_TIME TIMESTAMP NOT NULL,
	PRIMARY KEY (DENPYOU_ID)
) WITHOUT OIDS;
COMMENT ON TABLE RYOHI_KARIBARAI IS '旅費仮払';
COMMENT ON COLUMN RYOHI_KARIBARAI.DENPYOU_ID IS '伝票ID';
COMMENT ON COLUMN RYOHI_KARIBARAI.KARIBARAI_ON IS '仮払申請フラグ';
COMMENT ON COLUMN RYOHI_KARIBARAI.DAIRIFLG IS '代理フラグ';
COMMENT ON COLUMN RYOHI_KARIBARAI.USER_ID IS 'ユーザーID';
COMMENT ON COLUMN RYOHI_KARIBARAI.SHAIN_NO IS '社員番号';
COMMENT ON COLUMN RYOHI_KARIBARAI.USER_SEI IS 'ユーザー姓';
COMMENT ON COLUMN RYOHI_KARIBARAI.USER_MEI IS 'ユーザー名';
COMMENT ON COLUMN RYOHI_KARIBARAI.HOUMONSAKI IS '訪問先';
COMMENT ON COLUMN RYOHI_KARIBARAI.MOKUTEKI IS '目的';
COMMENT ON COLUMN RYOHI_KARIBARAI.SEISANKIKAN_FROM IS '精算期間開始日';
COMMENT ON COLUMN RYOHI_KARIBARAI.SEISANKIKAN_FROM_HOUR IS '精算期間開始時刻（時）';
COMMENT ON COLUMN RYOHI_KARIBARAI.SEISANKIKAN_FROM_MIN IS '精算期間開始時刻（分）';
COMMENT ON COLUMN RYOHI_KARIBARAI.SEISANKIKAN_TO IS '精算期間終了日';
COMMENT ON COLUMN RYOHI_KARIBARAI.SEISANKIKAN_TO_HOUR IS '精算期間終了時刻（時）';
COMMENT ON COLUMN RYOHI_KARIBARAI.SEISANKIKAN_TO_MIN IS '精算期間終了時刻（分）';
COMMENT ON COLUMN RYOHI_KARIBARAI.SHIHARAIBI IS '支払日';
COMMENT ON COLUMN RYOHI_KARIBARAI.SHIHARAIKIBOUBI IS '支払希望日';
COMMENT ON COLUMN RYOHI_KARIBARAI.SHIHARAIHOUHOU IS '支払方法';
COMMENT ON COLUMN RYOHI_KARIBARAI.TEKIYOU IS '摘要';
COMMENT ON COLUMN RYOHI_KARIBARAI.KINGAKU IS '金額';
COMMENT ON COLUMN RYOHI_KARIBARAI.KARIBARAI_KINGAKU IS '仮払金額';
COMMENT ON COLUMN RYOHI_KARIBARAI.HF1_CD IS 'HF1コード';
COMMENT ON COLUMN RYOHI_KARIBARAI.HF1_NAME_RYAKUSHIKI IS 'HF1名（略式）';
COMMENT ON COLUMN RYOHI_KARIBARAI.HF2_CD IS 'HF2コード';
COMMENT ON COLUMN RYOHI_KARIBARAI.HF2_NAME_RYAKUSHIKI IS 'HF2名（略式）';
COMMENT ON COLUMN RYOHI_KARIBARAI.HF3_CD IS 'HF3コード';
COMMENT ON COLUMN RYOHI_KARIBARAI.HF3_NAME_RYAKUSHIKI IS 'HF3名（略式）';
COMMENT ON COLUMN RYOHI_KARIBARAI.HOSOKU IS '補足';
COMMENT ON COLUMN RYOHI_KARIBARAI.SHIWAKE_EDANO IS '仕訳枝番号';
COMMENT ON COLUMN RYOHI_KARIBARAI.TORIHIKI_NAME IS '取引名';
COMMENT ON COLUMN RYOHI_KARIBARAI.KARI_FUTAN_BUMON_CD IS '借方負担部門コード';
COMMENT ON COLUMN RYOHI_KARIBARAI.KARI_FUTAN_BUMON_NAME IS '借方負担部門名';
COMMENT ON COLUMN RYOHI_KARIBARAI.KARI_KAMOKU_CD IS '借方科目コード';
COMMENT ON COLUMN RYOHI_KARIBARAI.KARI_KAMOKU_NAME IS '借方科目名';
COMMENT ON COLUMN RYOHI_KARIBARAI.KARI_KAMOKU_EDABAN_CD IS '借方科目枝番コード';
COMMENT ON COLUMN RYOHI_KARIBARAI.KARI_KAMOKU_EDABAN_NAME IS '借方科目枝番名';
COMMENT ON COLUMN RYOHI_KARIBARAI.KARI_KAZEI_KBN IS '借方課税区分';
COMMENT ON COLUMN RYOHI_KARIBARAI.KASHI_FUTAN_BUMON_CD IS '貸方負担部門コード';
COMMENT ON COLUMN RYOHI_KARIBARAI.KASHI_FUTAN_BUMON_NAME IS '貸方負担部門名';
COMMENT ON COLUMN RYOHI_KARIBARAI.KASHI_KAMOKU_CD IS '貸方科目コード';
COMMENT ON COLUMN RYOHI_KARIBARAI.KASHI_KAMOKU_NAME IS '貸方科目名';
COMMENT ON COLUMN RYOHI_KARIBARAI.KASHI_KAMOKU_EDABAN_CD IS '貸方科目枝番コード';
COMMENT ON COLUMN RYOHI_KARIBARAI.KASHI_KAMOKU_EDABAN_NAME IS '貸方科目枝番名';
COMMENT ON COLUMN RYOHI_KARIBARAI.KASHI_KAZEI_KBN IS '貸方課税区分';
COMMENT ON COLUMN RYOHI_KARIBARAI.UF1_CD IS 'UF1コード';
COMMENT ON COLUMN RYOHI_KARIBARAI.UF1_NAME_RYAKUSHIKI IS 'UF1名（略式）';
COMMENT ON COLUMN RYOHI_KARIBARAI.UF2_CD IS 'UF2コード';
COMMENT ON COLUMN RYOHI_KARIBARAI.UF2_NAME_RYAKUSHIKI IS 'UF2名（略式）';
COMMENT ON COLUMN RYOHI_KARIBARAI.UF3_CD IS 'UF3コード';
COMMENT ON COLUMN RYOHI_KARIBARAI.UF3_NAME_RYAKUSHIKI IS 'UF3名（略式）';
COMMENT ON COLUMN RYOHI_KARIBARAI.TEKIYOU_CD IS '摘要コード';
COMMENT ON COLUMN RYOHI_KARIBARAI.TOUROKU_USER_ID IS '登録ユーザーID';
COMMENT ON COLUMN RYOHI_KARIBARAI.TOUROKU_TIME IS '登録日時';
COMMENT ON COLUMN RYOHI_KARIBARAI.KOUSHIN_USER_ID IS '更新ユーザーID';
COMMENT ON COLUMN RYOHI_KARIBARAI.KOUSHIN_TIME IS '更新日時';

INSERT
INTO RYOHI_KARIBARAI(
	DENPYOU_ID,
	KARIBARAI_ON,
	DAIRIFLG,
	USER_ID,
	SHAIN_NO,
	USER_SEI,
	USER_MEI,
	HOUMONSAKI,
	MOKUTEKI,
	SEISANKIKAN_FROM,
	SEISANKIKAN_FROM_HOUR,
	SEISANKIKAN_FROM_MIN,
	SEISANKIKAN_TO,
	SEISANKIKAN_TO_HOUR,
	SEISANKIKAN_TO_MIN,
	SHIHARAIBI,
	SHIHARAIKIBOUBI,
	SHIHARAIHOUHOU,
	TEKIYOU,
	KINGAKU,
	KARIBARAI_KINGAKU,
	HF1_CD,
	HF1_NAME_RYAKUSHIKI,
	HF2_CD,
	HF2_NAME_RYAKUSHIKI,
	HF3_CD,
	HF3_NAME_RYAKUSHIKI,
	HOSOKU,
	SHIWAKE_EDANO,
	TORIHIKI_NAME,
	KARI_FUTAN_BUMON_CD,
	KARI_FUTAN_BUMON_NAME,
	KARI_KAMOKU_CD,
	KARI_KAMOKU_NAME,
	KARI_KAMOKU_EDABAN_CD,
	KARI_KAMOKU_EDABAN_NAME,
	KARI_KAZEI_KBN,
	KASHI_FUTAN_BUMON_CD,
	KASHI_FUTAN_BUMON_NAME,
	KASHI_KAMOKU_CD,
	KASHI_KAMOKU_NAME,
	KASHI_KAMOKU_EDABAN_CD,
	KASHI_KAMOKU_EDABAN_NAME,
	KASHI_KAZEI_KBN,
	UF1_CD,
	UF1_NAME_RYAKUSHIKI,
	UF2_CD,
	UF2_NAME_RYAKUSHIKI,
	UF3_CD,
	UF3_NAME_RYAKUSHIKI,
	TEKIYOU_CD,
	TOUROKU_USER_ID,
	TOUROKU_TIME,
	KOUSHIN_USER_ID,
	KOUSHIN_TIME
)
SELECT 
	r.DENPYOU_ID,
	r.KARIBARAI_ON,
	'0',
	s.USER_ID,
	COALESCE(u.SHAIN_NO,''),
	substring(USER_FULL_NAME, 0 , position('　' in USER_FULL_NAME)) as USER_SEI,
	substring(USER_FULL_NAME, position('　' in USER_FULL_NAME) + 1, CASE WHEN position('(' in USER_FULL_NAME) <> 0 THEN (position('(' in USER_FULL_NAME) - position('　' in USER_FULL_NAME) - 1) ELSE length(USER_FULL_NAME) END) as USER_MEI,
	r.HOUMONSAKI,
	r.MOKUTEKI,
	r.SEISANKIKAN_FROM,
	r.SEISANKIKAN_FROM_HOUR,
	r.SEISANKIKAN_FROM_MIN,
	r.SEISANKIKAN_TO,
	r.SEISANKIKAN_TO_HOUR,
	r.SEISANKIKAN_TO_MIN,
	r.SHIHARAIBI,
	r.SHIHARAIKIBOUBI,
	r.SHIHARAIHOUHOU,
	r.TEKIYOU,
	r.KINGAKU,
	r.KARIBARAI_KINGAKU,
	r.HF1_CD,
	r.HF1_NAME_RYAKUSHIKI,
	r.HF2_CD,
	r.HF2_NAME_RYAKUSHIKI,
	r.HF3_CD,
	r.HF3_NAME_RYAKUSHIKI,
	r.HOSOKU,
	r.SHIWAKE_EDANO,
	r.TORIHIKI_NAME,
	r.KARI_FUTAN_BUMON_CD,
	r.KARI_FUTAN_BUMON_NAME,
	r.KARI_KAMOKU_CD,
	r.KARI_KAMOKU_NAME,
	r.KARI_KAMOKU_EDABAN_CD,
	r.KARI_KAMOKU_EDABAN_NAME,
	r.KARI_KAZEI_KBN,
	r.KASHI_FUTAN_BUMON_CD,
	r.KASHI_FUTAN_BUMON_NAME,
	r.KASHI_KAMOKU_CD,
	r.KASHI_KAMOKU_NAME,
	r.KASHI_KAMOKU_EDABAN_CD,
	r.KASHI_KAMOKU_EDABAN_NAME,
	r.KASHI_KAZEI_KBN,
	r.UF1_CD,
	r.UF1_NAME_RYAKUSHIKI,
	r.UF2_CD,
	r.UF2_NAME_RYAKUSHIKI,
	r.UF3_CD,
	r.UF3_NAME_RYAKUSHIKI,
	r.TEKIYOU_CD,
	r.TOUROKU_USER_ID,
	r.TOUROKU_TIME,
	r.KOUSHIN_USER_ID,
	r.KOUSHIN_TIME
FROM (RYOHI_KARIBARAI_OLD r INNER JOIN SHOUNIN_ROUTE s ON r.denpyou_id = s.denpyou_id AND edano = 1)
LEFT OUTER JOIN USER_INFO u ON s.user_id = u.user_id;

DROP TABLE RYOHI_KARIBARAI_OLD;

-- 旅費仮払経費明細(ユーザー姓名の削除)
ALTER TABLE RYOHI_KARIBARAI_KEIHI_MEISAI RENAME TO RYOHI_KARIBARAI_KEIHI_MEISAI_OLD;
CREATE TABLE RYOHI_KARIBARAI_KEIHI_MEISAI
(
	DENPYOU_ID VARCHAR(19) NOT NULL,
	DENPYOU_EDANO INT NOT NULL,
	SHIWAKE_EDANO INT NOT NULL,
	SHIYOUBI DATE,
	SHOUHYOU_SHORUI_FLG VARCHAR(1),
	TORIHIKI_NAME VARCHAR(20) NOT NULL,
	TEKIYOU VARCHAR(60) NOT NULL,
	ZEIRITSU DECIMAL(3) NOT NULL,
	SHIHARAI_KINGAKU DECIMAL(15) NOT NULL,
	HONTAI_KINGAKU DECIMAL(15),
	SHOUHIZEIGAKU DECIMAL(15),
	KOUSAIHI_SHOUSAI_HYOUJI_FLG VARCHAR(1) NOT NULL,
	KOUSAIHI_SHOUSAI VARCHAR(240),
	KARI_FUTAN_BUMON_CD VARCHAR(8) NOT NULL,
	KARI_FUTAN_BUMON_NAME VARCHAR(20) NOT NULL,
	TORIHIKISAKI_CD VARCHAR(12) NOT NULL,
	TORIHIKISAKI_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	KARI_KAMOKU_CD VARCHAR(6) NOT NULL,
	KARI_KAMOKU_NAME VARCHAR(22) NOT NULL,
	KARI_KAMOKU_EDABAN_CD VARCHAR(12) NOT NULL,
	KARI_KAMOKU_EDABAN_NAME VARCHAR(20) NOT NULL,
	KARI_KAZEI_KBN VARCHAR(3) NOT NULL,
	KASHI_FUTAN_BUMON_CD VARCHAR(8) NOT NULL,
	KASHI_FUTAN_BUMON_NAME VARCHAR(20) NOT NULL,
	KASHI_KAMOKU_CD VARCHAR(6) NOT NULL,
	KASHI_KAMOKU_NAME VARCHAR(22) NOT NULL,
	KASHI_KAMOKU_EDABAN_CD VARCHAR(12) NOT NULL,
	KASHI_KAMOKU_EDABAN_NAME VARCHAR(20) NOT NULL,
	KASHI_KAZEI_KBN VARCHAR(3) NOT NULL,
	UF1_CD VARCHAR(20) NOT NULL,
	UF1_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	UF2_CD VARCHAR(20) NOT NULL,
	UF2_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	UF3_CD VARCHAR(20) NOT NULL,
	UF3_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	PROJECT_CD VARCHAR(12) NOT NULL,
	PROJECT_NAME VARCHAR(20) NOT NULL,
	TEKIYOU_CD VARCHAR(4) NOT NULL,
	TOUROKU_USER_ID VARCHAR(30) NOT NULL,
	TOUROKU_TIME TIMESTAMP NOT NULL,
	KOUSHIN_USER_ID VARCHAR(30) NOT NULL,
	KOUSHIN_TIME TIMESTAMP NOT NULL,
	PRIMARY KEY (DENPYOU_ID, DENPYOU_EDANO)
) WITHOUT OIDS;
COMMENT ON TABLE RYOHI_KARIBARAI_KEIHI_MEISAI IS '旅費仮払経費明細';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.DENPYOU_ID IS '伝票ID';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.DENPYOU_EDANO IS '伝票枝番号';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.SHIWAKE_EDANO IS '仕訳枝番号';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.SHIYOUBI IS '使用日';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.SHOUHYOU_SHORUI_FLG IS '証憑書類フラグ';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.TORIHIKI_NAME IS '取引名';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.TEKIYOU IS '摘要';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.ZEIRITSU IS '税率';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.SHIHARAI_KINGAKU IS '支払金額';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.HONTAI_KINGAKU IS '本体金額';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.SHOUHIZEIGAKU IS '消費税額';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.KOUSAIHI_SHOUSAI_HYOUJI_FLG IS '交際費詳細表示フラグ';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.KOUSAIHI_SHOUSAI IS '交際費詳細';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.KARI_FUTAN_BUMON_CD IS '借方負担部門コード';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.KARI_FUTAN_BUMON_NAME IS '借方負担部門名';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.TORIHIKISAKI_CD IS '取引先コード';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.TORIHIKISAKI_NAME_RYAKUSHIKI IS '取引先名（略式）';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.KARI_KAMOKU_CD IS '借方科目コード';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.KARI_KAMOKU_NAME IS '借方科目名';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.KARI_KAMOKU_EDABAN_CD IS '借方科目枝番コード';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.KARI_KAMOKU_EDABAN_NAME IS '借方科目枝番名';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.KARI_KAZEI_KBN IS '借方課税区分';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.KASHI_FUTAN_BUMON_CD IS '貸方負担部門コード';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.KASHI_FUTAN_BUMON_NAME IS '貸方負担部門名';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.KASHI_KAMOKU_CD IS '貸方科目コード';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.KASHI_KAMOKU_NAME IS '貸方科目名';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.KASHI_KAMOKU_EDABAN_CD IS '貸方科目枝番コード';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.KASHI_KAMOKU_EDABAN_NAME IS '貸方科目枝番名';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.KASHI_KAZEI_KBN IS '貸方課税区分';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.UF1_CD IS 'UF1コード';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.UF1_NAME_RYAKUSHIKI IS 'UF1名（略式）';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.UF2_CD IS 'UF2コード';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.UF2_NAME_RYAKUSHIKI IS 'UF2名（略式）';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.UF3_CD IS 'UF3コード';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.UF3_NAME_RYAKUSHIKI IS 'UF3名（略式）';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.PROJECT_CD IS 'プロジェクトコード';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.PROJECT_NAME IS 'プロジェクト名';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.TEKIYOU_CD IS '摘要コード';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.TOUROKU_USER_ID IS '登録ユーザーID';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.TOUROKU_TIME IS '登録日時';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.KOUSHIN_USER_ID IS '更新ユーザーID';
COMMENT ON COLUMN RYOHI_KARIBARAI_KEIHI_MEISAI.KOUSHIN_TIME IS '更新日時';

INSERT
INTO RYOHI_KARIBARAI_KEIHI_MEISAI(
	DENPYOU_ID,
	DENPYOU_EDANO,
	SHIWAKE_EDANO,
	SHIYOUBI,
	SHOUHYOU_SHORUI_FLG,
	TORIHIKI_NAME,
	TEKIYOU,
	ZEIRITSU,
	SHIHARAI_KINGAKU,
	HONTAI_KINGAKU,
	SHOUHIZEIGAKU,
	KOUSAIHI_SHOUSAI_HYOUJI_FLG,
	KOUSAIHI_SHOUSAI,
	KARI_FUTAN_BUMON_CD,
	KARI_FUTAN_BUMON_NAME,
	TORIHIKISAKI_CD,
	TORIHIKISAKI_NAME_RYAKUSHIKI,
	KARI_KAMOKU_CD,
	KARI_KAMOKU_NAME,
	KARI_KAMOKU_EDABAN_CD,
	KARI_KAMOKU_EDABAN_NAME,
	KARI_KAZEI_KBN,
	KASHI_FUTAN_BUMON_CD,
	KASHI_FUTAN_BUMON_NAME,
	KASHI_KAMOKU_CD,
	KASHI_KAMOKU_NAME,
	KASHI_KAMOKU_EDABAN_CD,
	KASHI_KAMOKU_EDABAN_NAME,
	KASHI_KAZEI_KBN,
	UF1_CD,
	UF1_NAME_RYAKUSHIKI,
	UF2_CD,
	UF2_NAME_RYAKUSHIKI,
	UF3_CD,
	UF3_NAME_RYAKUSHIKI,
	PROJECT_CD,
	PROJECT_NAME,
	TEKIYOU_CD,
	TOUROKU_USER_ID,
	TOUROKU_TIME,
	KOUSHIN_USER_ID,
	KOUSHIN_TIME
)
SELECT
	DENPYOU_ID,
	DENPYOU_EDANO,
	SHIWAKE_EDANO,
	SHIYOUBI,
	SHOUHYOU_SHORUI_FLG,
	TORIHIKI_NAME,
	TEKIYOU,
	ZEIRITSU,
	SHIHARAI_KINGAKU,
	HONTAI_KINGAKU,
	SHOUHIZEIGAKU,
	KOUSAIHI_SHOUSAI_HYOUJI_FLG,
	KOUSAIHI_SHOUSAI,
	KARI_FUTAN_BUMON_CD,
	KARI_FUTAN_BUMON_NAME,
	TORIHIKISAKI_CD,
	TORIHIKISAKI_NAME_RYAKUSHIKI,
	KARI_KAMOKU_CD,
	KARI_KAMOKU_NAME,
	KARI_KAMOKU_EDABAN_CD,
	KARI_KAMOKU_EDABAN_NAME,
	KARI_KAZEI_KBN,
	KASHI_FUTAN_BUMON_CD,
	KASHI_FUTAN_BUMON_NAME,
	KASHI_KAMOKU_CD,
	KASHI_KAMOKU_NAME,
	KASHI_KAMOKU_EDABAN_CD,
	KASHI_KAMOKU_EDABAN_NAME,
	KASHI_KAZEI_KBN,
	UF1_CD,
	UF1_NAME_RYAKUSHIKI,
	UF2_CD,
	UF2_NAME_RYAKUSHIKI,
	UF3_CD,
	UF3_NAME_RYAKUSHIKI,
	PROJECT_CD,
	PROJECT_NAME,
	TEKIYOU_CD,
	TOUROKU_USER_ID,
	TOUROKU_TIME,
	KOUSHIN_USER_ID,
	KOUSHIN_TIME
FROM RYOHI_KARIBARAI_KEIHI_MEISAI_OLD;

DROP TABLE RYOHI_KARIBARAI_KEIHI_MEISAI_OLD;

--海外出張精算
CREATE TABLE KAIGAI_RYOHISEISAN
(
	DENPYOU_ID VARCHAR(19) NOT NULL,
	KARIBARAI_DENPYOU_ID VARCHAR(19) NOT NULL,
	KARIBARAI_ON VARCHAR(1) NOT NULL,
	KARIBARAI_MISHIYOU_FLG VARCHAR(1) DEFAULT '0' NOT NULL,
	DAIRIFLG VARCHAR(1) NOT NULL,
	USER_ID VARCHAR(30) NOT NULL,
	SHAIN_NO VARCHAR(15) NOT NULL,
	USER_SEI VARCHAR(10) NOT NULL,
	USER_MEI VARCHAR(10) NOT NULL,
	HOUMONSAKI VARCHAR(120) NOT NULL,
	MOKUTEKI VARCHAR(240) NOT NULL,
	SEISANKIKAN_FROM DATE,
	SEISANKIKAN_FROM_HOUR VARCHAR(2),
	SEISANKIKAN_FROM_MIN VARCHAR(2),
	SEISANKIKAN_TO DATE,
	SEISANKIKAN_TO_HOUR VARCHAR(2),
	SEISANKIKAN_TO_MIN VARCHAR(2),
	KEIJOUBI DATE,
	SHIHARAIBI DATE,
	SHIHARAIKIBOUBI DATE,
	SHIHARAIHOUHOU VARCHAR(1) NOT NULL,
	TEKIYOU VARCHAR(60) NOT NULL,
	KAIGAI_TEKIYOU VARCHAR(60) NOT NULL,
	ZEIRITSU DECIMAL(3) NOT NULL,
	GOUKEI_KINGAKU DECIMAL(15) NOT NULL,
	HOUJIN_CARD_RIYOU_KINGAKU DECIMAL(15) NOT NULL,
	KAISHA_TEHAI_KINGAKU DECIMAL(15) NOT NULL,
	SASHIHIKI_SHIKYUU_KINGAKU DECIMAL(15) NOT NULL,
	HF1_CD VARCHAR(20) NOT NULL,
	HF1_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	HF2_CD VARCHAR(20) NOT NULL,
	HF2_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	HF3_CD VARCHAR(20) NOT NULL,
	HF3_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	HOSOKU VARCHAR(240) NOT NULL,
	SHIWAKE_EDANO INT,
	TORIHIKI_NAME VARCHAR(20) NOT NULL,
	KARI_FUTAN_BUMON_CD VARCHAR(8) NOT NULL,
	KARI_FUTAN_BUMON_NAME VARCHAR(20) NOT NULL,
	KARI_KAMOKU_CD VARCHAR(6) NOT NULL,
	KARI_KAMOKU_NAME VARCHAR(22) NOT NULL,
	KARI_KAMOKU_EDABAN_CD VARCHAR(12) NOT NULL,
	KARI_KAMOKU_EDABAN_NAME VARCHAR(20) NOT NULL,
	KARI_KAZEI_KBN VARCHAR(3) NOT NULL,
	RYOHI_KAZEI_FLG VARCHAR(1) NOT NULL,
	KASHI_FUTAN_BUMON_CD VARCHAR(8) NOT NULL,
	KASHI_FUTAN_BUMON_NAME VARCHAR(20) NOT NULL,
	KASHI_KAMOKU_CD VARCHAR(6) NOT NULL,
	KASHI_KAMOKU_NAME VARCHAR(22) NOT NULL,
	KASHI_KAMOKU_EDABAN_CD VARCHAR(12) NOT NULL,
	KASHI_KAMOKU_EDABAN_NAME VARCHAR(20) NOT NULL,
	KASHI_KAZEI_KBN VARCHAR(3) NOT NULL,
	UF1_CD VARCHAR(20) NOT NULL,
	UF1_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	UF2_CD VARCHAR(20) NOT NULL,
	UF2_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	UF3_CD VARCHAR(20) NOT NULL,
	UF3_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	PROJECT_CD VARCHAR(12) NOT NULL,
	PROJECT_NAME VARCHAR(20) NOT NULL,
	TEKIYOU_CD VARCHAR(4) NOT NULL,
	KAIGAI_SHIWAKE_EDANO INT,
	KAIGAI_TORIHIKI_NAME VARCHAR(20) NOT NULL,
	KAIGAI_KARI_FUTAN_BUMON_CD VARCHAR(8) NOT NULL,
	KAIGAI_KARI_FUTAN_BUMON_NAME VARCHAR(20) NOT NULL,
	KAIGAI_KARI_KAMOKU_CD VARCHAR(6) NOT NULL,
	KAIGAI_KARI_KAMOKU_NAME VARCHAR(22) NOT NULL,
	KAIGAI_KARI_KAMOKU_EDABAN_CD VARCHAR(12) NOT NULL,
	KAIGAI_KARI_KAMOKU_EDABAN_NAME VARCHAR(20) NOT NULL,
	KAIGAI_KARI_KAZEI_KBN VARCHAR(3) NOT NULL,
	KAIGAI_KAZEI_FLG VARCHAR(1) NOT NULL,
	KAIGAI_KASHI_FUTAN_BUMON_CD VARCHAR(8) NOT NULL,
	KAIGAI_KASHI_FUTAN_BUMON_NAME VARCHAR(20) NOT NULL,
	KAIGAI_KASHI_KAMOKU_CD VARCHAR(6) NOT NULL,
	KAIGAI_KASHI_KAMOKU_NAME VARCHAR(22) NOT NULL,
	KAIGAI_KASHI_KAMOKU_EDABAN_CD VARCHAR(12) NOT NULL,
	KAIGAI_KASHI_KAMOKU_EDABAN_NAME VARCHAR(20) NOT NULL,
	KAIGAI_KASHI_KAZEI_KBN VARCHAR(3) NOT NULL,
	KAIGAI_UF1_CD VARCHAR(20) NOT NULL,
	KAIGAI_UF1_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	KAIGAI_UF2_CD VARCHAR(20) NOT NULL,
	KAIGAI_UF2_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	KAIGAI_UF3_CD VARCHAR(20) NOT NULL,
	KAIGAI_UF3_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	KAIGAI_PROJECT_CD VARCHAR(12) NOT NULL,
	KAIGAI_PROJECT_NAME VARCHAR(20) NOT NULL,
	KAIGAI_TEKIYOU_CD VARCHAR(4) NOT NULL,
	TOUROKU_USER_ID VARCHAR(30) NOT NULL,
	TOUROKU_TIME TIMESTAMP NOT NULL,
	KOUSHIN_USER_ID VARCHAR(30) NOT NULL,
	KOUSHIN_TIME TIMESTAMP NOT NULL,
	PRIMARY KEY (DENPYOU_ID)
) WITHOUT OIDS;
COMMENT ON TABLE KAIGAI_RYOHISEISAN IS '海外旅費精算';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.DENPYOU_ID IS '伝票ID';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KARIBARAI_DENPYOU_ID IS '仮払伝票ID';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KARIBARAI_ON IS '仮払申請フラグ';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KARIBARAI_MISHIYOU_FLG IS '仮払金未使用フラグ';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.DAIRIFLG IS '代理フラグ';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.USER_ID IS 'ユーザーID';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.SHAIN_NO IS '社員番号';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.USER_SEI IS 'ユーザー姓';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.USER_MEI IS 'ユーザー名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.HOUMONSAKI IS '訪問先';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.MOKUTEKI IS '目的';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.SEISANKIKAN_FROM IS '精算期間開始日';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.SEISANKIKAN_FROM_HOUR IS '精算期間開始時刻（時）';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.SEISANKIKAN_FROM_MIN IS '精算期間開始時刻（分）';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.SEISANKIKAN_TO IS '精算期間終了日';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.SEISANKIKAN_TO_HOUR IS '精算期間終了時刻（時）';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.SEISANKIKAN_TO_MIN IS '精算期間終了時刻（分）';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KEIJOUBI IS '計上日';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.SHIHARAIBI IS '支払日';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.SHIHARAIKIBOUBI IS '支払希望日';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.SHIHARAIHOUHOU IS '支払方法';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.TEKIYOU IS '摘要';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_TEKIYOU IS '摘要（海外）';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.ZEIRITSU IS '税率';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.GOUKEI_KINGAKU IS '合計金額';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.HOUJIN_CARD_RIYOU_KINGAKU IS '内法人カード利用合計';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAISHA_TEHAI_KINGAKU IS '会社手配合計';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.SASHIHIKI_SHIKYUU_KINGAKU IS '差引支給金額';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.HF1_CD IS 'HF1コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.HF1_NAME_RYAKUSHIKI IS 'HF1名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.HF2_CD IS 'HF2コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.HF2_NAME_RYAKUSHIKI IS 'HF2名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.HF3_CD IS 'HF3コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.HF3_NAME_RYAKUSHIKI IS 'HF3名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.HOSOKU IS '補足';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.SHIWAKE_EDANO IS '仕訳枝番号';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.TORIHIKI_NAME IS '取引名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KARI_FUTAN_BUMON_CD IS '借方負担部門コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KARI_FUTAN_BUMON_NAME IS '借方負担部門名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KARI_KAMOKU_CD IS '借方科目コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KARI_KAMOKU_NAME IS '借方科目名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KARI_KAMOKU_EDABAN_CD IS '借方科目枝番コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KARI_KAMOKU_EDABAN_NAME IS '借方科目枝番名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KARI_KAZEI_KBN IS '借方課税区分';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.RYOHI_KAZEI_FLG IS '旅費課税フラグ';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KASHI_FUTAN_BUMON_CD IS '貸方負担部門コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KASHI_FUTAN_BUMON_NAME IS '貸方負担部門名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KASHI_KAMOKU_CD IS '貸方科目コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KASHI_KAMOKU_NAME IS '貸方科目名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KASHI_KAMOKU_EDABAN_CD IS '貸方科目枝番コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KASHI_KAMOKU_EDABAN_NAME IS '貸方科目枝番名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KASHI_KAZEI_KBN IS '貸方課税区分';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.UF1_CD IS 'UF1コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.UF1_NAME_RYAKUSHIKI IS 'UF1名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.UF2_CD IS 'UF2コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.UF2_NAME_RYAKUSHIKI IS 'UF2名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.UF3_CD IS 'UF3コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.UF3_NAME_RYAKUSHIKI IS 'UF3名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.PROJECT_CD IS 'プロジェクトコード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.PROJECT_NAME IS 'プロジェクト名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.TEKIYOU_CD IS '摘要コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_SHIWAKE_EDANO IS '海外仕訳枝番号';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_TORIHIKI_NAME IS '海外取引名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_KARI_FUTAN_BUMON_CD IS '海外借方負担部門コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_KARI_FUTAN_BUMON_NAME IS '海外借方負担部門名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_KARI_KAMOKU_CD IS '海外借方科目コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_KARI_KAMOKU_NAME IS '海外借方科目名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_KARI_KAMOKU_EDABAN_CD IS '海外借方科目枝番コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_KARI_KAMOKU_EDABAN_NAME IS '海外借方科目枝番名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_KARI_KAZEI_KBN IS '海外借方課税区分';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_KAZEI_FLG IS '海外課税フラグ';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_KASHI_FUTAN_BUMON_CD IS '海外貸方負担部門コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_KASHI_FUTAN_BUMON_NAME IS '海外貸方負担部門名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_KASHI_KAMOKU_CD IS '海外貸方科目コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_KASHI_KAMOKU_NAME IS '海外貸方科目名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_KASHI_KAMOKU_EDABAN_CD IS '海外貸方科目枝番コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_KASHI_KAMOKU_EDABAN_NAME IS '海外貸方科目枝番名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_KASHI_KAZEI_KBN IS '海外貸方課税区分';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_UF1_CD IS '海外UF1コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_UF1_NAME_RYAKUSHIKI IS '海外UF1名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_UF2_CD IS '海外UF2コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_UF2_NAME_RYAKUSHIKI IS '海外UF2名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_UF3_CD IS '海外UF3コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_UF3_NAME_RYAKUSHIKI IS '海外UF3名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_PROJECT_CD IS '海外プロジェクトコード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_PROJECT_NAME IS '海外プロジェクト名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KAIGAI_TEKIYOU_CD IS '海外摘要コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.TOUROKU_USER_ID IS '登録ユーザーID';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.TOUROKU_TIME IS '登録日時';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KOUSHIN_USER_ID IS '更新ユーザーID';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN.KOUSHIN_TIME IS '更新日時';

--海外出張精算経費明細
CREATE TABLE KAIGAI_RYOHISEISAN_KEIHI_MEISAI
(
	DENPYOU_ID VARCHAR(19) NOT NULL,
	DENPYOU_EDANO INT NOT NULL,
	KAIGAI_FLG VARCHAR(1) NOT NULL,
	SHIWAKE_EDANO INT NOT NULL,
	SHIYOUBI DATE,
	SHOUHYOU_SHORUI_FLG VARCHAR(1),
	TORIHIKI_NAME VARCHAR(20) NOT NULL,
	TEKIYOU VARCHAR(60) NOT NULL,
	ZEIRITSU DECIMAL(3) NOT NULL,
	KAZEI_FLG VARCHAR(1) NOT NULL,
	SHIHARAI_KINGAKU DECIMAL(15) NOT NULL,
	HONTAI_KINGAKU DECIMAL(15),
	SHOUHIZEIGAKU DECIMAL(15),
	HOUJIN_CARD_RIYOU_FLG VARCHAR(1) NOT NULL,
	KAISHA_TEHAI_FLG VARCHAR(1) NOT NULL,
	KOUSAIHI_SHOUSAI_HYOUJI_FLG VARCHAR(1) NOT NULL,
	KOUSAIHI_SHOUSAI VARCHAR(240),
	HEISHU_CD VARCHAR(4),
	RATE DECIMAL(11,5),
	GAIKA DECIMAL(19,2),
	CURRENCY_UNIT VARCHAR(20),
	KARI_FUTAN_BUMON_CD VARCHAR(8) NOT NULL,
	KARI_FUTAN_BUMON_NAME VARCHAR(20) NOT NULL,
	TORIHIKISAKI_CD VARCHAR(12) NOT NULL,
	TORIHIKISAKI_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	KARI_KAMOKU_CD VARCHAR(6) NOT NULL,
	KARI_KAMOKU_NAME VARCHAR(22) NOT NULL,
	KARI_KAMOKU_EDABAN_CD VARCHAR(12) NOT NULL,
	KARI_KAMOKU_EDABAN_NAME VARCHAR(20) NOT NULL,
	KARI_KAZEI_KBN VARCHAR(3) NOT NULL,
	KASHI_FUTAN_BUMON_CD VARCHAR(8) NOT NULL,
	KASHI_FUTAN_BUMON_NAME VARCHAR(20) NOT NULL,
	KASHI_KAMOKU_CD VARCHAR(6) NOT NULL,
	KASHI_KAMOKU_NAME VARCHAR(22) NOT NULL,
	KASHI_KAMOKU_EDABAN_CD VARCHAR(12) NOT NULL,
	KASHI_KAMOKU_EDABAN_NAME VARCHAR(20) NOT NULL,
	KASHI_KAZEI_KBN VARCHAR(3) NOT NULL,
	UF1_CD VARCHAR(20) NOT NULL,
	UF1_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	UF2_CD VARCHAR(20) NOT NULL,
	UF2_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	UF3_CD VARCHAR(20) NOT NULL,
	UF3_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	PROJECT_CD VARCHAR(12) NOT NULL,
	PROJECT_NAME VARCHAR(20) NOT NULL,
	TEKIYOU_CD VARCHAR(4) NOT NULL,
	TOUROKU_USER_ID VARCHAR(30) NOT NULL,
	TOUROKU_TIME TIMESTAMP NOT NULL,
	KOUSHIN_USER_ID VARCHAR(30) NOT NULL,
	KOUSHIN_TIME TIMESTAMP NOT NULL,
	PRIMARY KEY (DENPYOU_ID, DENPYOU_EDANO, KAIGAI_FLG)
) WITHOUT OIDS;
COMMENT ON TABLE KAIGAI_RYOHISEISAN_KEIHI_MEISAI IS '海外旅費精算経費明細';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.DENPYOU_ID IS '伝票ID';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.DENPYOU_EDANO IS '伝票枝番号';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.KAIGAI_FLG IS '海外フラグ';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.SHIWAKE_EDANO IS '仕訳枝番号';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.SHIYOUBI IS '使用日';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.SHOUHYOU_SHORUI_FLG IS '証憑書類フラグ';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.TORIHIKI_NAME IS '取引名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.TEKIYOU IS '摘要';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.ZEIRITSU IS '税率';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.KAZEI_FLG IS '課税フラグ';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.SHIHARAI_KINGAKU IS '支払金額';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.HONTAI_KINGAKU IS '本体金額';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.SHOUHIZEIGAKU IS '消費税額';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.HOUJIN_CARD_RIYOU_FLG IS '法人カード利用フラグ';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.KAISHA_TEHAI_FLG IS '会社手配フラグ';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.KOUSAIHI_SHOUSAI_HYOUJI_FLG IS '交際費詳細表示フラグ';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.KOUSAIHI_SHOUSAI IS '交際費詳細';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.HEISHU_CD IS '幣種コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.RATE IS 'レート';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.GAIKA IS '外貨金額';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.CURRENCY_UNIT IS '通貨単位';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.KARI_FUTAN_BUMON_CD IS '借方負担部門コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.KARI_FUTAN_BUMON_NAME IS '借方負担部門名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.TORIHIKISAKI_CD IS '取引先コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.TORIHIKISAKI_NAME_RYAKUSHIKI IS '取引先名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.KARI_KAMOKU_CD IS '借方科目コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.KARI_KAMOKU_NAME IS '借方科目名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.KARI_KAMOKU_EDABAN_CD IS '借方科目枝番コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.KARI_KAMOKU_EDABAN_NAME IS '借方科目枝番名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.KARI_KAZEI_KBN IS '借方課税区分';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.KASHI_FUTAN_BUMON_CD IS '貸方負担部門コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.KASHI_FUTAN_BUMON_NAME IS '貸方負担部門名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.KASHI_KAMOKU_CD IS '貸方科目コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.KASHI_KAMOKU_NAME IS '貸方科目名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.KASHI_KAMOKU_EDABAN_CD IS '貸方科目枝番コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.KASHI_KAMOKU_EDABAN_NAME IS '貸方科目枝番名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.KASHI_KAZEI_KBN IS '貸方課税区分';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.UF1_CD IS 'UF1コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.UF1_NAME_RYAKUSHIKI IS 'UF1名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.UF2_CD IS 'UF2コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.UF2_NAME_RYAKUSHIKI IS 'UF2名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.UF3_CD IS 'UF3コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.UF3_NAME_RYAKUSHIKI IS 'UF3名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.PROJECT_CD IS 'プロジェクトコード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.PROJECT_NAME IS 'プロジェクト名';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.TEKIYOU_CD IS '摘要コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.TOUROKU_USER_ID IS '登録ユーザーID';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.TOUROKU_TIME IS '登録日時';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.KOUSHIN_USER_ID IS '更新ユーザーID';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_KEIHI_MEISAI.KOUSHIN_TIME IS '更新日時';

--海外出張精算明細
CREATE TABLE KAIGAI_RYOHISEISAN_MEISAI
(
	DENPYOU_ID VARCHAR(19) NOT NULL,
	KAIGAI_FLG VARCHAR(1) NOT NULL,
	DENPYOU_EDANO INT NOT NULL,
	KIKAN_FROM DATE NOT NULL,
	KIKAN_TO DATE,
	KYUUJITSU_NISSUU NUMERIC,
	SHUBETSU_CD VARCHAR(1) NOT NULL,
	SHUBETSU1 VARCHAR(20) NOT NULL,
	SHUBETSU2 VARCHAR(20) NOT NULL,
	KOUTSUU_SHUDAN VARCHAR(10) NOT NULL,
	SHOUHYOU_SHORUI_HISSU_FLG VARCHAR(1) NOT NULL,
	RYOUSHUUSHO_SEIKYUUSHO_TOU_FLG CHAR(1) NOT NULL,
	NAIYOU VARCHAR(512) NOT NULL,
	BIKOU VARCHAR(200) NOT NULL,
	OUFUKU_FLG VARCHAR(1) NOT NULL,
	HOUJIN_CARD_RIYOU_FLG VARCHAR(1) NOT NULL,
	KAISHA_TEHAI_FLG VARCHAR(1) NOT NULL,
	JIDOUNYUURYOKU_FLG VARCHAR(1) NOT NULL,
	NISSUU NUMERIC,
	HEISHU_CD VARCHAR(4),
	RATE DECIMAL(11,5),
	GAIKA DECIMAL(19,2),
	CURRENCY_UNIT VARCHAR(20),
	TANKA DECIMAL(15) NOT NULL,
	MEISAI_KINGAKU DECIMAL(15) NOT NULL,
	TOUROKU_USER_ID VARCHAR(30) NOT NULL,
	TOUROKU_TIME TIMESTAMP NOT NULL,
	KOUSHIN_USER_ID VARCHAR(30) NOT NULL,
	KOUSHIN_TIME TIMESTAMP NOT NULL,
	PRIMARY KEY (DENPYOU_ID, KAIGAI_FLG, DENPYOU_EDANO)
) WITHOUT OIDS;
COMMENT ON TABLE KAIGAI_RYOHISEISAN_MEISAI IS '海外旅費精算明細';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.DENPYOU_ID IS '伝票ID';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.KAIGAI_FLG IS '海外フラグ';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.DENPYOU_EDANO IS '伝票枝番号';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.KIKAN_FROM IS '期間開始日';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.KIKAN_TO IS '期間終了日';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.KYUUJITSU_NISSUU IS '休日日数';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.SHUBETSU_CD IS '種別コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.SHUBETSU1 IS '種別１';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.SHUBETSU2 IS '種別２';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.KOUTSUU_SHUDAN IS '交通手段';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.SHOUHYOU_SHORUI_HISSU_FLG IS '証憑書類必須フラグ';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.RYOUSHUUSHO_SEIKYUUSHO_TOU_FLG IS '領収書・請求書等フラグ';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.NAIYOU IS '内容（旅費精算）';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.BIKOU IS '備考（旅費精算）';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.OUFUKU_FLG IS '往復フラグ';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.HOUJIN_CARD_RIYOU_FLG IS '法人カード利用フラグ';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.KAISHA_TEHAI_FLG IS '会社手配フラグ';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.JIDOUNYUURYOKU_FLG IS '自動入力フラグ';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.NISSUU IS '日数';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.HEISHU_CD IS '幣種コード';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.RATE IS 'レート';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.GAIKA IS '外貨金額';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.CURRENCY_UNIT IS '通貨単位';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.TANKA IS '単価';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.MEISAI_KINGAKU IS '明細金額';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.TOUROKU_USER_ID IS '登録ユーザーID';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.TOUROKU_TIME IS '登録日時';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.KOUSHIN_USER_ID IS '更新ユーザーID';
COMMENT ON COLUMN KAIGAI_RYOHISEISAN_MEISAI.KOUSHIN_TIME IS '更新日時';

--海外出張伺い申請
CREATE TABLE KAIGAI_RYOHI_KARIBARAI
(
	DENPYOU_ID VARCHAR(19) NOT NULL,
	KARIBARAI_ON VARCHAR(1) DEFAULT '0' NOT NULL,
	DAIRIFLG VARCHAR(1) NOT NULL,
	USER_ID VARCHAR(30),
	SHAIN_NO VARCHAR(15) NOT NULL,
	USER_SEI VARCHAR(10) NOT NULL,
	USER_MEI VARCHAR(10) NOT NULL,
	HOUMONSAKI VARCHAR(120) NOT NULL,
	MOKUTEKI VARCHAR(240) NOT NULL,
	SEISANKIKAN_FROM DATE,
	SEISANKIKAN_FROM_HOUR VARCHAR(2),
	SEISANKIKAN_FROM_MIN VARCHAR(2),
	SEISANKIKAN_TO DATE,
	SEISANKIKAN_TO_HOUR VARCHAR(2),
	SEISANKIKAN_TO_MIN VARCHAR(2),
	SHIHARAIBI DATE,
	SHIHARAIKIBOUBI DATE,
	SHIHARAIHOUHOU VARCHAR(1) NOT NULL,
	TEKIYOU VARCHAR(60) NOT NULL,
	KINGAKU DECIMAL(15) NOT NULL,
	KARIBARAI_KINGAKU DECIMAL(15),
	HF1_CD VARCHAR(20) NOT NULL,
	HF1_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	HF2_CD VARCHAR(20) NOT NULL,
	HF2_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	HF3_CD VARCHAR(20) NOT NULL,
	HF3_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	HOSOKU VARCHAR(240) NOT NULL,
	SHIWAKE_EDANO INT,
	TORIHIKI_NAME VARCHAR(20) NOT NULL,
	KARI_FUTAN_BUMON_CD VARCHAR(8) NOT NULL,
	KARI_FUTAN_BUMON_NAME VARCHAR(20) NOT NULL,
	KARI_KAMOKU_CD VARCHAR(6) NOT NULL,
	KARI_KAMOKU_NAME VARCHAR(22) NOT NULL,
	KARI_KAMOKU_EDABAN_CD VARCHAR(12) NOT NULL,
	KARI_KAMOKU_EDABAN_NAME VARCHAR(20) NOT NULL,
	KARI_KAZEI_KBN VARCHAR(3) NOT NULL,
	KASHI_FUTAN_BUMON_CD VARCHAR(8) NOT NULL,
	KASHI_FUTAN_BUMON_NAME VARCHAR(20) NOT NULL,
	KASHI_KAMOKU_CD VARCHAR(6) NOT NULL,
	KASHI_KAMOKU_NAME VARCHAR(22) NOT NULL,
	KASHI_KAMOKU_EDABAN_CD VARCHAR(12) NOT NULL,
	KASHI_KAMOKU_EDABAN_NAME VARCHAR(20) NOT NULL,
	KASHI_KAZEI_KBN VARCHAR(3) NOT NULL,
	UF1_CD VARCHAR(20) NOT NULL,
	UF1_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	UF2_CD VARCHAR(20) NOT NULL,
	UF2_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	UF3_CD VARCHAR(20) NOT NULL,
	UF3_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	TEKIYOU_CD VARCHAR(4) NOT NULL,
	TOUROKU_USER_ID VARCHAR(30) NOT NULL,
	TOUROKU_TIME TIMESTAMP NOT NULL,
	KOUSHIN_USER_ID VARCHAR(30) NOT NULL,
	KOUSHIN_TIME TIMESTAMP NOT NULL,
	PRIMARY KEY (DENPYOU_ID)
) WITHOUT OIDS;
COMMENT ON TABLE KAIGAI_RYOHI_KARIBARAI IS '海外旅費仮払';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.DENPYOU_ID IS '伝票ID';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.KARIBARAI_ON IS '仮払申請フラグ';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.DAIRIFLG IS '代理フラグ';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.USER_ID IS 'ユーザーID';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.SHAIN_NO IS '社員番号';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.USER_SEI IS 'ユーザー姓';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.USER_MEI IS 'ユーザー名';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.HOUMONSAKI IS '訪問先';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.MOKUTEKI IS '目的';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.SEISANKIKAN_FROM IS '精算期間開始日';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.SEISANKIKAN_FROM_HOUR IS '精算期間開始時刻（時）';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.SEISANKIKAN_FROM_MIN IS '精算期間開始時刻（分）';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.SEISANKIKAN_TO IS '精算期間終了日';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.SEISANKIKAN_TO_HOUR IS '精算期間終了時刻（時）';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.SEISANKIKAN_TO_MIN IS '精算期間終了時刻（分）';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.SHIHARAIBI IS '支払日';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.SHIHARAIKIBOUBI IS '支払希望日';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.SHIHARAIHOUHOU IS '支払方法';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.TEKIYOU IS '摘要';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.KINGAKU IS '金額';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.KARIBARAI_KINGAKU IS '仮払金額';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.HF1_CD IS 'HF1コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.HF1_NAME_RYAKUSHIKI IS 'HF1名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.HF2_CD IS 'HF2コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.HF2_NAME_RYAKUSHIKI IS 'HF2名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.HF3_CD IS 'HF3コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.HF3_NAME_RYAKUSHIKI IS 'HF3名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.HOSOKU IS '補足';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.SHIWAKE_EDANO IS '仕訳枝番号';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.TORIHIKI_NAME IS '取引名';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.KARI_FUTAN_BUMON_CD IS '借方負担部門コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.KARI_FUTAN_BUMON_NAME IS '借方負担部門名';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.KARI_KAMOKU_CD IS '借方科目コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.KARI_KAMOKU_NAME IS '借方科目名';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.KARI_KAMOKU_EDABAN_CD IS '借方科目枝番コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.KARI_KAMOKU_EDABAN_NAME IS '借方科目枝番名';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.KARI_KAZEI_KBN IS '借方課税区分';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.KASHI_FUTAN_BUMON_CD IS '貸方負担部門コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.KASHI_FUTAN_BUMON_NAME IS '貸方負担部門名';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.KASHI_KAMOKU_CD IS '貸方科目コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.KASHI_KAMOKU_NAME IS '貸方科目名';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.KASHI_KAMOKU_EDABAN_CD IS '貸方科目枝番コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.KASHI_KAMOKU_EDABAN_NAME IS '貸方科目枝番名';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.KASHI_KAZEI_KBN IS '貸方課税区分';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.UF1_CD IS 'UF1コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.UF1_NAME_RYAKUSHIKI IS 'UF1名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.UF2_CD IS 'UF2コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.UF2_NAME_RYAKUSHIKI IS 'UF2名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.UF3_CD IS 'UF3コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.UF3_NAME_RYAKUSHIKI IS 'UF3名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.TEKIYOU_CD IS '摘要コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.TOUROKU_USER_ID IS '登録ユーザーID';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.TOUROKU_TIME IS '登録日時';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.KOUSHIN_USER_ID IS '更新ユーザーID';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI.KOUSHIN_TIME IS '更新日時';

--海外出張伺い申請経費明細
CREATE TABLE KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI
(
	DENPYOU_ID VARCHAR(19) NOT NULL,
	DENPYOU_EDANO INT NOT NULL,
	KAIGAI_FLG VARCHAR(1) NOT NULL,
	SHIWAKE_EDANO INT NOT NULL,
	SHIYOUBI DATE,
	SHOUHYOU_SHORUI_FLG VARCHAR(1),
	TORIHIKI_NAME VARCHAR(20) NOT NULL,
	TEKIYOU VARCHAR(60) NOT NULL,
	ZEIRITSU DECIMAL(3) NOT NULL,
	KAZEI_FLG VARCHAR(1) NOT NULL,
	SHIHARAI_KINGAKU DECIMAL(15) NOT NULL,
	HONTAI_KINGAKU DECIMAL(15),
	SHOUHIZEIGAKU DECIMAL(15),
	KOUSAIHI_SHOUSAI_HYOUJI_FLG VARCHAR(1) NOT NULL,
	KOUSAIHI_SHOUSAI VARCHAR(240),
	HEISHU_CD VARCHAR(4),
	RATE DECIMAL(11,5),
	GAIKA DECIMAL(19,2),
	CURRENCY_UNIT VARCHAR(20),
	KARI_FUTAN_BUMON_CD VARCHAR(8) NOT NULL,
	KARI_FUTAN_BUMON_NAME VARCHAR(20) NOT NULL,
	TORIHIKISAKI_CD VARCHAR(12) NOT NULL,
	TORIHIKISAKI_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	KARI_KAMOKU_CD VARCHAR(6) NOT NULL,
	KARI_KAMOKU_NAME VARCHAR(22) NOT NULL,
	KARI_KAMOKU_EDABAN_CD VARCHAR(12) NOT NULL,
	KARI_KAMOKU_EDABAN_NAME VARCHAR(20) NOT NULL,
	KARI_KAZEI_KBN VARCHAR(3) NOT NULL,
	KASHI_FUTAN_BUMON_CD VARCHAR(8) NOT NULL,
	KASHI_FUTAN_BUMON_NAME VARCHAR(20) NOT NULL,
	KASHI_KAMOKU_CD VARCHAR(6) NOT NULL,
	KASHI_KAMOKU_NAME VARCHAR(22) NOT NULL,
	KASHI_KAMOKU_EDABAN_CD VARCHAR(12) NOT NULL,
	KASHI_KAMOKU_EDABAN_NAME VARCHAR(20) NOT NULL,
	KASHI_KAZEI_KBN VARCHAR(3) NOT NULL,
	UF1_CD VARCHAR(20) NOT NULL,
	UF1_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	UF2_CD VARCHAR(20) NOT NULL,
	UF2_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	UF3_CD VARCHAR(20) NOT NULL,
	UF3_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	PROJECT_CD VARCHAR(12) NOT NULL,
	PROJECT_NAME VARCHAR(20) NOT NULL,
	TEKIYOU_CD VARCHAR(4) NOT NULL,
	TOUROKU_USER_ID VARCHAR(30) NOT NULL,
	TOUROKU_TIME TIMESTAMP NOT NULL,
	KOUSHIN_USER_ID VARCHAR(30) NOT NULL,
	KOUSHIN_TIME TIMESTAMP NOT NULL,
	PRIMARY KEY (DENPYOU_ID, DENPYOU_EDANO, KAIGAI_FLG)
) WITHOUT OIDS;
COMMENT ON TABLE KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI IS '海外旅費仮払経費明細';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.DENPYOU_ID IS '伝票ID';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.DENPYOU_EDANO IS '伝票枝番号';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.KAIGAI_FLG IS '海外フラグ';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.SHIWAKE_EDANO IS '仕訳枝番号';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.SHIYOUBI IS '使用日';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.SHOUHYOU_SHORUI_FLG IS '証憑書類フラグ';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.TORIHIKI_NAME IS '取引名';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.TEKIYOU IS '摘要';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.ZEIRITSU IS '税率';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.KAZEI_FLG IS '課税フラグ';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.SHIHARAI_KINGAKU IS '支払金額';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.HONTAI_KINGAKU IS '本体金額';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.SHOUHIZEIGAKU IS '消費税額';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.KOUSAIHI_SHOUSAI_HYOUJI_FLG IS '交際費詳細表示フラグ';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.KOUSAIHI_SHOUSAI IS '交際費詳細';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.HEISHU_CD IS '幣種コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.RATE IS 'レート';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.GAIKA IS '外貨金額';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.CURRENCY_UNIT IS '通貨単位';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.KARI_FUTAN_BUMON_CD IS '借方負担部門コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.KARI_FUTAN_BUMON_NAME IS '借方負担部門名';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.TORIHIKISAKI_CD IS '取引先コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.TORIHIKISAKI_NAME_RYAKUSHIKI IS '取引先名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.KARI_KAMOKU_CD IS '借方科目コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.KARI_KAMOKU_NAME IS '借方科目名';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.KARI_KAMOKU_EDABAN_CD IS '借方科目枝番コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.KARI_KAMOKU_EDABAN_NAME IS '借方科目枝番名';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.KARI_KAZEI_KBN IS '借方課税区分';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.KASHI_FUTAN_BUMON_CD IS '貸方負担部門コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.KASHI_FUTAN_BUMON_NAME IS '貸方負担部門名';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.KASHI_KAMOKU_CD IS '貸方科目コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.KASHI_KAMOKU_NAME IS '貸方科目名';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.KASHI_KAMOKU_EDABAN_CD IS '貸方科目枝番コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.KASHI_KAMOKU_EDABAN_NAME IS '貸方科目枝番名';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.KASHI_KAZEI_KBN IS '貸方課税区分';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.UF1_CD IS 'UF1コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.UF1_NAME_RYAKUSHIKI IS 'UF1名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.UF2_CD IS 'UF2コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.UF2_NAME_RYAKUSHIKI IS 'UF2名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.UF3_CD IS 'UF3コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.UF3_NAME_RYAKUSHIKI IS 'UF3名（略式）';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.PROJECT_CD IS 'プロジェクトコード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.PROJECT_NAME IS 'プロジェクト名';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.TEKIYOU_CD IS '摘要コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.TOUROKU_USER_ID IS '登録ユーザーID';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.TOUROKU_TIME IS '登録日時';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.KOUSHIN_USER_ID IS '更新ユーザーID';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_KEIHI_MEISAI.KOUSHIN_TIME IS '更新日時';

--海外出張伺い申請明細
CREATE TABLE KAIGAI_RYOHI_KARIBARAI_MEISAI
(
	DENPYOU_ID VARCHAR(19) NOT NULL,
	KAIGAI_FLG VARCHAR(1) NOT NULL,
	DENPYOU_EDANO INT NOT NULL,
	KIKAN_FROM DATE NOT NULL,
	KIKAN_TO DATE,
	KYUUJITSU_NISSUU NUMERIC,
	SHUBETSU_CD VARCHAR(1) NOT NULL,
	SHUBETSU1 VARCHAR(20) NOT NULL,
	SHUBETSU2 VARCHAR(20) NOT NULL,
	KOUTSUU_SHUDAN VARCHAR(10) NOT NULL,
	SHOUHYOU_SHORUI_HISSU_FLG VARCHAR(1) NOT NULL,
	NAIYOU VARCHAR(512) NOT NULL,
	BIKOU VARCHAR(200) NOT NULL,
	OUFUKU_FLG VARCHAR(1) NOT NULL,
	JIDOUNYUURYOKU_FLG VARCHAR(1) NOT NULL,
	NISSUU NUMERIC,
	HEISHU_CD VARCHAR(4),
	RATE DECIMAL(11,5),
	GAIKA DECIMAL(19,2),
	CURRENCY_UNIT VARCHAR(20),
	TANKA DECIMAL(15) NOT NULL,
	MEISAI_KINGAKU DECIMAL(15) NOT NULL,
	TOUROKU_USER_ID VARCHAR(30) NOT NULL,
	TOUROKU_TIME TIMESTAMP NOT NULL,
	KOUSHIN_USER_ID VARCHAR(30) NOT NULL,
	KOUSHIN_TIME TIMESTAMP NOT NULL,
	PRIMARY KEY (DENPYOU_ID, KAIGAI_FLG, DENPYOU_EDANO)
) WITHOUT OIDS;
COMMENT ON TABLE KAIGAI_RYOHI_KARIBARAI_MEISAI IS '海外旅費仮払明細';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.DENPYOU_ID IS '伝票ID';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.KAIGAI_FLG IS '海外フラグ';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.DENPYOU_EDANO IS '伝票枝番号';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.KIKAN_FROM IS '期間開始日';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.KIKAN_TO IS '期間終了日';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.KYUUJITSU_NISSUU IS '休日日数';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.SHUBETSU_CD IS '種別コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.SHUBETSU1 IS '種別１';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.SHUBETSU2 IS '種別２';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.KOUTSUU_SHUDAN IS '交通手段';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.SHOUHYOU_SHORUI_HISSU_FLG IS '証憑書類必須フラグ';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.NAIYOU IS '内容（旅費精算）';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.BIKOU IS '備考（旅費精算）';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.OUFUKU_FLG IS '往復フラグ';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.JIDOUNYUURYOKU_FLG IS '自動入力フラグ';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.NISSUU IS '日数';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.HEISHU_CD IS '幣種コード';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.RATE IS 'レート';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.GAIKA IS '外貨金額';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.CURRENCY_UNIT IS '通貨単位';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.TANKA IS '単価';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.MEISAI_KINGAKU IS '明細金額';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.TOUROKU_USER_ID IS '登録ユーザーID';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.TOUROKU_TIME IS '登録日時';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.KOUSHIN_USER_ID IS '更新ユーザーID';
COMMENT ON COLUMN KAIGAI_RYOHI_KARIBARAI_MEISAI.KOUSHIN_TIME IS '更新日時';

-- 交通費精算に会社手配合計を追加
ALTER TABLE KOUTSUUHISEISAN RENAME TO KOUTSUUHISEISAN_OLD;
CREATE TABLE KOUTSUUHISEISAN
(
	DENPYOU_ID VARCHAR(19) NOT NULL,
	MOKUTEKI VARCHAR(240) NOT NULL,
	SEISANKIKAN_FROM DATE,
	SEISANKIKAN_FROM_HOUR VARCHAR(2),
	SEISANKIKAN_FROM_MIN VARCHAR(2),
	SEISANKIKAN_TO DATE,
	SEISANKIKAN_TO_HOUR VARCHAR(2),
	SEISANKIKAN_TO_MIN VARCHAR(2),
	KEIJOUBI DATE,
	SHIHARAIBI DATE,
	SHIHARAIKIBOUBI DATE,
	SHIHARAIHOUHOU VARCHAR(1) NOT NULL,
	TEKIYOU VARCHAR(60) NOT NULL,
	ZEIRITSU DECIMAL(3) NOT NULL,
	GOUKEI_KINGAKU DECIMAL(15) NOT NULL,
	HOUJIN_CARD_RIYOU_KINGAKU DECIMAL(15) NOT NULL,
	KAISHA_TEHAI_KINGAKU DECIMAL(15) NOT NULL,
	SASHIHIKI_SHIKYUU_KINGAKU DECIMAL(15) NOT NULL,
	HF1_CD VARCHAR(20) NOT NULL,
	HF1_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	HF2_CD VARCHAR(20) NOT NULL,
	HF2_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	HF3_CD VARCHAR(20) NOT NULL,
	HF3_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	HOSOKU VARCHAR(240) NOT NULL,
	SHIWAKE_EDANO INT,
	TORIHIKI_NAME VARCHAR(20) NOT NULL,
	KARI_FUTAN_BUMON_CD VARCHAR(8) NOT NULL,
	KARI_FUTAN_BUMON_NAME VARCHAR(20) NOT NULL,
	KARI_KAMOKU_CD VARCHAR(6) NOT NULL,
	KARI_KAMOKU_NAME VARCHAR(22) NOT NULL,
	KARI_KAMOKU_EDABAN_CD VARCHAR(12) NOT NULL,
	KARI_KAMOKU_EDABAN_NAME VARCHAR(20) NOT NULL,
	KARI_KAZEI_KBN VARCHAR(3) NOT NULL,
	KASHI_FUTAN_BUMON_CD VARCHAR(8) NOT NULL,
	KASHI_FUTAN_BUMON_NAME VARCHAR(20) NOT NULL,
	KASHI_KAMOKU_CD VARCHAR(6) NOT NULL,
	KASHI_KAMOKU_NAME VARCHAR(22) NOT NULL,
	KASHI_KAMOKU_EDABAN_CD VARCHAR(12) NOT NULL,
	KASHI_KAMOKU_EDABAN_NAME VARCHAR(20) NOT NULL,
	KASHI_KAZEI_KBN VARCHAR(3) NOT NULL,
	UF1_CD VARCHAR(20) NOT NULL,
	UF1_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	UF2_CD VARCHAR(20) NOT NULL,
	UF2_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	UF3_CD VARCHAR(20) NOT NULL,
	UF3_NAME_RYAKUSHIKI VARCHAR(20) NOT NULL,
	PROJECT_CD VARCHAR(12) NOT NULL,
	PROJECT_NAME VARCHAR(20) NOT NULL,
	TEKIYOU_CD VARCHAR(4) NOT NULL,
	TOUROKU_USER_ID VARCHAR(30) NOT NULL,
	TOUROKU_TIME TIMESTAMP NOT NULL,
	KOUSHIN_USER_ID VARCHAR(30) NOT NULL,
	KOUSHIN_TIME TIMESTAMP NOT NULL,
	PRIMARY KEY (DENPYOU_ID)
) WITHOUT OIDS;
COMMENT ON TABLE KOUTSUUHISEISAN IS '交通費精算';
COMMENT ON COLUMN KOUTSUUHISEISAN.DENPYOU_ID IS '伝票ID';
COMMENT ON COLUMN KOUTSUUHISEISAN.MOKUTEKI IS '目的';
COMMENT ON COLUMN KOUTSUUHISEISAN.SEISANKIKAN_FROM IS '精算期間開始日';
COMMENT ON COLUMN KOUTSUUHISEISAN.SEISANKIKAN_FROM_HOUR IS '精算期間開始時刻（時）';
COMMENT ON COLUMN KOUTSUUHISEISAN.SEISANKIKAN_FROM_MIN IS '精算期間開始時刻（分）';
COMMENT ON COLUMN KOUTSUUHISEISAN.SEISANKIKAN_TO IS '精算期間終了日';
COMMENT ON COLUMN KOUTSUUHISEISAN.SEISANKIKAN_TO_HOUR IS '精算期間終了時刻（時）';
COMMENT ON COLUMN KOUTSUUHISEISAN.SEISANKIKAN_TO_MIN IS '精算期間終了時刻（分）';
COMMENT ON COLUMN KOUTSUUHISEISAN.KEIJOUBI IS '計上日';
COMMENT ON COLUMN KOUTSUUHISEISAN.SHIHARAIBI IS '支払日';
COMMENT ON COLUMN KOUTSUUHISEISAN.SHIHARAIKIBOUBI IS '支払希望日';
COMMENT ON COLUMN KOUTSUUHISEISAN.SHIHARAIHOUHOU IS '支払方法';
COMMENT ON COLUMN KOUTSUUHISEISAN.TEKIYOU IS '摘要';
COMMENT ON COLUMN KOUTSUUHISEISAN.ZEIRITSU IS '税率';
COMMENT ON COLUMN KOUTSUUHISEISAN.GOUKEI_KINGAKU IS '合計金額';
COMMENT ON COLUMN KOUTSUUHISEISAN.HOUJIN_CARD_RIYOU_KINGAKU IS '内法人カード利用合計';
COMMENT ON COLUMN KOUTSUUHISEISAN.KAISHA_TEHAI_KINGAKU IS '会社手配合計';
COMMENT ON COLUMN KOUTSUUHISEISAN.SASHIHIKI_SHIKYUU_KINGAKU IS '差引支給金額';
COMMENT ON COLUMN KOUTSUUHISEISAN.HF1_CD IS 'HF1コード';
COMMENT ON COLUMN KOUTSUUHISEISAN.HF1_NAME_RYAKUSHIKI IS 'HF1名（略式）';
COMMENT ON COLUMN KOUTSUUHISEISAN.HF2_CD IS 'HF2コード';
COMMENT ON COLUMN KOUTSUUHISEISAN.HF2_NAME_RYAKUSHIKI IS 'HF2名（略式）';
COMMENT ON COLUMN KOUTSUUHISEISAN.HF3_CD IS 'HF3コード';
COMMENT ON COLUMN KOUTSUUHISEISAN.HF3_NAME_RYAKUSHIKI IS 'HF3名（略式）';
COMMENT ON COLUMN KOUTSUUHISEISAN.HOSOKU IS '補足';
COMMENT ON COLUMN KOUTSUUHISEISAN.SHIWAKE_EDANO IS '仕訳枝番号';
COMMENT ON COLUMN KOUTSUUHISEISAN.TORIHIKI_NAME IS '取引名';
COMMENT ON COLUMN KOUTSUUHISEISAN.KARI_FUTAN_BUMON_CD IS '借方負担部門コード';
COMMENT ON COLUMN KOUTSUUHISEISAN.KARI_FUTAN_BUMON_NAME IS '借方負担部門名';
COMMENT ON COLUMN KOUTSUUHISEISAN.KARI_KAMOKU_CD IS '借方科目コード';
COMMENT ON COLUMN KOUTSUUHISEISAN.KARI_KAMOKU_NAME IS '借方科目名';
COMMENT ON COLUMN KOUTSUUHISEISAN.KARI_KAMOKU_EDABAN_CD IS '借方科目枝番コード';
COMMENT ON COLUMN KOUTSUUHISEISAN.KARI_KAMOKU_EDABAN_NAME IS '借方科目枝番名';
COMMENT ON COLUMN KOUTSUUHISEISAN.KARI_KAZEI_KBN IS '借方課税区分';
COMMENT ON COLUMN KOUTSUUHISEISAN.KASHI_FUTAN_BUMON_CD IS '貸方負担部門コード';
COMMENT ON COLUMN KOUTSUUHISEISAN.KASHI_FUTAN_BUMON_NAME IS '貸方負担部門名';
COMMENT ON COLUMN KOUTSUUHISEISAN.KASHI_KAMOKU_CD IS '貸方科目コード';
COMMENT ON COLUMN KOUTSUUHISEISAN.KASHI_KAMOKU_NAME IS '貸方科目名';
COMMENT ON COLUMN KOUTSUUHISEISAN.KASHI_KAMOKU_EDABAN_CD IS '貸方科目枝番コード';
COMMENT ON COLUMN KOUTSUUHISEISAN.KASHI_KAMOKU_EDABAN_NAME IS '貸方科目枝番名';
COMMENT ON COLUMN KOUTSUUHISEISAN.KASHI_KAZEI_KBN IS '貸方課税区分';
COMMENT ON COLUMN KOUTSUUHISEISAN.UF1_CD IS 'UF1コード';
COMMENT ON COLUMN KOUTSUUHISEISAN.UF1_NAME_RYAKUSHIKI IS 'UF1名（略式）';
COMMENT ON COLUMN KOUTSUUHISEISAN.UF2_CD IS 'UF2コード';
COMMENT ON COLUMN KOUTSUUHISEISAN.UF2_NAME_RYAKUSHIKI IS 'UF2名（略式）';
COMMENT ON COLUMN KOUTSUUHISEISAN.UF3_CD IS 'UF3コード';
COMMENT ON COLUMN KOUTSUUHISEISAN.UF3_NAME_RYAKUSHIKI IS 'UF3名（略式）';
COMMENT ON COLUMN KOUTSUUHISEISAN.PROJECT_CD IS 'プロジェクトコード';
COMMENT ON COLUMN KOUTSUUHISEISAN.PROJECT_NAME IS 'プロジェクト名';
COMMENT ON COLUMN KOUTSUUHISEISAN.TEKIYOU_CD IS '摘要コード';
COMMENT ON COLUMN KOUTSUUHISEISAN.TOUROKU_USER_ID IS '登録ユーザーID';
COMMENT ON COLUMN KOUTSUUHISEISAN.TOUROKU_TIME IS '登録日時';
COMMENT ON COLUMN KOUTSUUHISEISAN.KOUSHIN_USER_ID IS '更新ユーザーID';
COMMENT ON COLUMN KOUTSUUHISEISAN.KOUSHIN_TIME IS '更新日時';
INSERT
INTO KOUTSUUHISEISAN(
	DENPYOU_ID,
	MOKUTEKI,
	SEISANKIKAN_FROM,
	SEISANKIKAN_FROM_HOUR,
	SEISANKIKAN_FROM_MIN,
	SEISANKIKAN_TO,
	SEISANKIKAN_TO_HOUR,
	SEISANKIKAN_TO_MIN,
	KEIJOUBI,
	SHIHARAIBI,
	SHIHARAIKIBOUBI,
	SHIHARAIHOUHOU,
	TEKIYOU,
	ZEIRITSU,
	GOUKEI_KINGAKU,
	HOUJIN_CARD_RIYOU_KINGAKU,
	KAISHA_TEHAI_KINGAKU,
	SASHIHIKI_SHIKYUU_KINGAKU,
	HF1_CD,
	HF1_NAME_RYAKUSHIKI,
	HF2_CD,
	HF2_NAME_RYAKUSHIKI,
	HF3_CD,
	HF3_NAME_RYAKUSHIKI,
	HOSOKU,
	SHIWAKE_EDANO,
	TORIHIKI_NAME,
	KARI_FUTAN_BUMON_CD,
	KARI_FUTAN_BUMON_NAME,
	KARI_KAMOKU_CD,
	KARI_KAMOKU_NAME,
	KARI_KAMOKU_EDABAN_CD,
	KARI_KAMOKU_EDABAN_NAME,
	KARI_KAZEI_KBN,
	KASHI_FUTAN_BUMON_CD,
	KASHI_FUTAN_BUMON_NAME,
	KASHI_KAMOKU_CD,
	KASHI_KAMOKU_NAME,
	KASHI_KAMOKU_EDABAN_CD,
	KASHI_KAMOKU_EDABAN_NAME,
	KASHI_KAZEI_KBN,
	UF1_CD,
	UF1_NAME_RYAKUSHIKI,
	UF2_CD,
	UF2_NAME_RYAKUSHIKI,
	UF3_CD,
	UF3_NAME_RYAKUSHIKI,
	PROJECT_CD,
	PROJECT_NAME,
	TEKIYOU_CD,
	TOUROKU_USER_ID,
	TOUROKU_TIME,
	KOUSHIN_USER_ID,
	KOUSHIN_TIME
)
SELECT
	DENPYOU_ID,
	MOKUTEKI,
	SEISANKIKAN_FROM,
	SEISANKIKAN_FROM_HOUR,
	SEISANKIKAN_FROM_MIN,
	SEISANKIKAN_TO,
	SEISANKIKAN_TO_HOUR,
	SEISANKIKAN_TO_MIN,
	KEIJOUBI,
	SHIHARAIBI,
	SHIHARAIKIBOUBI,
	SHIHARAIHOUHOU,
	TEKIYOU,
	ZEIRITSU,
	GOUKEI_KINGAKU,
	HOUJIN_CARD_RIYOU_KINGAKU,
	0,
	SASHIHIKI_SHIKYUU_KINGAKU,
	HF1_CD,
	HF1_NAME_RYAKUSHIKI,
	HF2_CD,
	HF2_NAME_RYAKUSHIKI,
	HF3_CD,
	HF3_NAME_RYAKUSHIKI,
	HOSOKU,
	SHIWAKE_EDANO,
	TORIHIKI_NAME,
	KARI_FUTAN_BUMON_CD,
	KARI_FUTAN_BUMON_NAME,
	KARI_KAMOKU_CD,
	KARI_KAMOKU_NAME,
	KARI_KAMOKU_EDABAN_CD,
	KARI_KAMOKU_EDABAN_NAME,
	KARI_KAZEI_KBN,
	KASHI_FUTAN_BUMON_CD,
	KASHI_FUTAN_BUMON_NAME,
	KASHI_KAMOKU_CD,
	KASHI_KAMOKU_NAME,
	KASHI_KAMOKU_EDABAN_CD,
	KASHI_KAMOKU_EDABAN_NAME,
	KASHI_KAZEI_KBN,
	UF1_CD,
	UF1_NAME_RYAKUSHIKI,
	UF2_CD,
	UF2_NAME_RYAKUSHIKI,
	UF3_CD,
	UF3_NAME_RYAKUSHIKI,
	PROJECT_CD,
	PROJECT_NAME,
	TEKIYOU_CD,
	TOUROKU_USER_ID,
	TOUROKU_TIME,
	KOUSHIN_USER_ID,
	KOUSHIN_TIME
FROM KOUTSUUHISEISAN_OLD;

DROP TABLE KOUTSUUHISEISAN_OLD;

-- 交通費精算明細に会社手配フラグを追加
ALTER TABLE KOUTSUUHISEISAN_MEISAI RENAME TO KOUTSUUHISEISAN_MEISAI_OLD;
CREATE TABLE KOUTSUUHISEISAN_MEISAI
(
	DENPYOU_ID VARCHAR(19) NOT NULL,
	DENPYOU_EDANO INT NOT NULL,
	KIKAN_FROM DATE NOT NULL,
	SHUBETSU_CD VARCHAR(1) NOT NULL,
	SHUBETSU1 VARCHAR(20) NOT NULL,
	SHUBETSU2 VARCHAR(20) NOT NULL,
	KOUTSUU_SHUDAN VARCHAR(10) NOT NULL,
	SHOUHYOU_SHORUI_HISSU_FLG VARCHAR(1) NOT NULL,
	RYOUSHUUSHO_SEIKYUUSHO_TOU_FLG CHAR(1) NOT NULL,
	NAIYOU VARCHAR(512) NOT NULL,
	BIKOU VARCHAR(200) NOT NULL,
	OUFUKU_FLG VARCHAR(1) NOT NULL,
	HOUJIN_CARD_RIYOU_FLG VARCHAR(1) NOT NULL,
	KAISHA_TEHAI_FLG VARCHAR(1) NOT NULL,
	JIDOUNYUURYOKU_FLG VARCHAR(1) NOT NULL,
	TANKA DECIMAL(15) NOT NULL,
	MEISAI_KINGAKU DECIMAL(15) NOT NULL,
	TOUROKU_USER_ID VARCHAR(30) NOT NULL,
	TOUROKU_TIME TIMESTAMP NOT NULL,
	KOUSHIN_USER_ID VARCHAR(30) NOT NULL,
	KOUSHIN_TIME TIMESTAMP NOT NULL,
	PRIMARY KEY (DENPYOU_ID, DENPYOU_EDANO)
) WITHOUT OIDS;
COMMENT ON TABLE KOUTSUUHISEISAN_MEISAI IS '交通費精算明細';
COMMENT ON COLUMN KOUTSUUHISEISAN_MEISAI.DENPYOU_ID IS '伝票ID';
COMMENT ON COLUMN KOUTSUUHISEISAN_MEISAI.DENPYOU_EDANO IS '伝票枝番号';
COMMENT ON COLUMN KOUTSUUHISEISAN_MEISAI.KIKAN_FROM IS '期間開始日';
COMMENT ON COLUMN KOUTSUUHISEISAN_MEISAI.SHUBETSU_CD IS '種別コード';
COMMENT ON COLUMN KOUTSUUHISEISAN_MEISAI.SHUBETSU1 IS '種別１';
COMMENT ON COLUMN KOUTSUUHISEISAN_MEISAI.SHUBETSU2 IS '種別２';
COMMENT ON COLUMN KOUTSUUHISEISAN_MEISAI.KOUTSUU_SHUDAN IS '交通手段';
COMMENT ON COLUMN KOUTSUUHISEISAN_MEISAI.SHOUHYOU_SHORUI_HISSU_FLG IS '証憑書類必須フラグ';
COMMENT ON COLUMN KOUTSUUHISEISAN_MEISAI.RYOUSHUUSHO_SEIKYUUSHO_TOU_FLG IS '領収書・請求書等フラグ';
COMMENT ON COLUMN KOUTSUUHISEISAN_MEISAI.NAIYOU IS '内容（旅費精算）';
COMMENT ON COLUMN KOUTSUUHISEISAN_MEISAI.BIKOU IS '備考（旅費精算）';
COMMENT ON COLUMN KOUTSUUHISEISAN_MEISAI.OUFUKU_FLG IS '往復フラグ';
COMMENT ON COLUMN KOUTSUUHISEISAN_MEISAI.HOUJIN_CARD_RIYOU_FLG IS '法人カード利用フラグ';
COMMENT ON COLUMN KOUTSUUHISEISAN_MEISAI.KAISHA_TEHAI_FLG IS '会社手配フラグ';
COMMENT ON COLUMN KOUTSUUHISEISAN_MEISAI.JIDOUNYUURYOKU_FLG IS '自動入力フラグ';
COMMENT ON COLUMN KOUTSUUHISEISAN_MEISAI.TANKA IS '単価';
COMMENT ON COLUMN KOUTSUUHISEISAN_MEISAI.MEISAI_KINGAKU IS '明細金額';
COMMENT ON COLUMN KOUTSUUHISEISAN_MEISAI.TOUROKU_USER_ID IS '登録ユーザーID';
COMMENT ON COLUMN KOUTSUUHISEISAN_MEISAI.TOUROKU_TIME IS '登録日時';
COMMENT ON COLUMN KOUTSUUHISEISAN_MEISAI.KOUSHIN_USER_ID IS '更新ユーザーID';
COMMENT ON COLUMN KOUTSUUHISEISAN_MEISAI.KOUSHIN_TIME IS '更新日時';
INSERT
INTO KOUTSUUHISEISAN_MEISAI(
	DENPYOU_ID,
	DENPYOU_EDANO,
	KIKAN_FROM,
	SHUBETSU_CD,
	SHUBETSU1,
	SHUBETSU2,
	KOUTSUU_SHUDAN,
	SHOUHYOU_SHORUI_HISSU_FLG,
	RYOUSHUUSHO_SEIKYUUSHO_TOU_FLG,
	NAIYOU,
	BIKOU,
	OUFUKU_FLG,
	HOUJIN_CARD_RIYOU_FLG,
	KAISHA_TEHAI_FLG,
	JIDOUNYUURYOKU_FLG,
	TANKA,
	MEISAI_KINGAKU,
	TOUROKU_USER_ID,
	TOUROKU_TIME,
	KOUSHIN_USER_ID,
	KOUSHIN_TIME
)
SELECT 
	DENPYOU_ID,
	DENPYOU_EDANO,
	KIKAN_FROM,
	SHUBETSU_CD,
	SHUBETSU1,
	SHUBETSU2,
	KOUTSUU_SHUDAN,
	SHOUHYOU_SHORUI_HISSU_FLG,
	RYOUSHUUSHO_SEIKYUUSHO_TOU_FLG,
	NAIYOU,
	BIKOU,
	OUFUKU_FLG,
	HOUJIN_CARD_RIYOU_FLG,
	'0',
	JIDOUNYUURYOKU_FLG,
	TANKA,
	MEISAI_KINGAKU,
	TOUROKU_USER_ID,
	TOUROKU_TIME,
	KOUSHIN_USER_ID,
	KOUSHIN_TIME
FROM KOUTSUUHISEISAN_MEISAI_OLD;

DROP TABLE KOUTSUUHISEISAN_MEISAI_OLD;

-- 日当等マスターの名称を変更
ALTER TABLE NITTOU_NADO_MASTER RENAME TO NITTOU_NADO_MASTER_OLD;
CREATE TABLE NITTOU_NADO_MASTER
(
	SHUBETSU1 VARCHAR(20) NOT NULL,
	SHUBETSU2 VARCHAR(20) NOT NULL,
	YAKUSHOKU_CD VARCHAR(10) NOT NULL,
	TANKA DECIMAL(15),
	SHOUHYOU_SHORUI_HISSU_FLG VARCHAR(1) NOT NULL,
	NITTOU_SHUKUHAKUHI_FLG VARCHAR(1) NOT NULL,
	PRIMARY KEY (SHUBETSU1, SHUBETSU2, YAKUSHOKU_CD)
) WITHOUT OIDS;
COMMENT ON TABLE NITTOU_NADO_MASTER IS '国内用日当等マスター';
COMMENT ON COLUMN NITTOU_NADO_MASTER.SHUBETSU1 IS '種別１';
COMMENT ON COLUMN NITTOU_NADO_MASTER.SHUBETSU2 IS '種別２';
COMMENT ON COLUMN NITTOU_NADO_MASTER.YAKUSHOKU_CD IS '役職コード';
COMMENT ON COLUMN NITTOU_NADO_MASTER.TANKA IS '単価';
COMMENT ON COLUMN NITTOU_NADO_MASTER.SHOUHYOU_SHORUI_HISSU_FLG IS '証憑書類必須フラグ';
COMMENT ON COLUMN NITTOU_NADO_MASTER.NITTOU_SHUKUHAKUHI_FLG IS '日当・宿泊費フラグ';
INSERT
INTO NITTOU_NADO_MASTER(
	SHUBETSU1,
	SHUBETSU2,
	YAKUSHOKU_CD,
	TANKA,
	SHOUHYOU_SHORUI_HISSU_FLG,
	NITTOU_SHUKUHAKUHI_FLG
)
SELECT
	SHUBETSU1,
	SHUBETSU2,
	YAKUSHOKU_CD,
	TANKA,
	SHOUHYOU_SHORUI_HISSU_FLG,
	'0'
FROM NITTOU_NADO_MASTER_OLD;

DROP TABLE NITTOU_NADO_MASTER_OLD;

-- 国内用日当等マスター管理版数の値を変更
-- 全て新しく作り直してINSERT
UPDATE master_kanri_hansuu SET delete_flg = '1' WHERE master_id = 'nittou_nado_master';
INSERT INTO master_kanri_hansuu 
(
  master_id
  , version
  , delete_flg
  , file_name
  , file_size
  , content_type
  , binary_data
  , touroku_user_id 
  , touroku_time 
  , koushin_user_id 
  , koushin_time 
)
SELECT 
   'nittou_nado_master' as master_id
 , (SELECT MAX(version) + 1 FROM master_kanri_hansuu WHERE master_id ='nittou_nado_master') as version
 , '0' as delete_flg
 , '国内用日当等マスター_patch.csv' as file_name
 , length(convert_to(E'種別１,種別２,役職コード,単価,証憑書類必須,フラグ日当・宿泊費フラグ\r\nshubetsu1,shubetsu2,yakushoku_cd,tanka,shouhyou_shorui_hissu_flg,nittou_shukuhakuhi_flg\r\nvarchar(20),varchar(20),varchar(10),decimal(15),varchar(1),varchar(1)\r\n1,1,1,,2,2\r\n' || ARRAY_TO_STRING(ARRAY(SELECT shubetsu1 || ',' || shubetsu2 || ',' || yakushoku_cd || ',' || COALESCE(tanka::TEXT, '') || ',' || shouhyou_shorui_hissu_flg || ',' || nittou_shukuhakuhi_flg FROM nittou_nado_master), E'\r\n') || E'\r\n','sjis') ) as file_size
 , 'application/vnd.ms-excel' as content_type
 , convert_to(E'種別１,種別２,役職コード,単価,証憑書類必須,フラグ日当・宿泊費フラグ\r\nshubetsu1,shubetsu2,yakushoku_cd,tanka,shouhyou_shorui_hissu_flg,nittou_shukuhakuhi_flg\r\nvarchar(20),varchar(20),varchar(10),decimal(15),varchar(1),varchar(1)\r\n1,1,1,,2,2\r\n' || ARRAY_TO_STRING(ARRAY(SELECT shubetsu1 || ',' || shubetsu2 || ',' || yakushoku_cd || ',' || COALESCE(tanka::TEXT, '') || ',' || shouhyou_shorui_hissu_flg || ',' || nittou_shukuhakuhi_flg FROM nittou_nado_master), E'\r\n') || E'\r\n','sjis') as binary_data
 , 'patch' as koushin_time
 , current_timestamp as touroku_user_id
 , 'patch' as touroku_time
 , current_timestamp as koushin_user_id
 ;

-- マスター管理の処理対象テーブル追加(海外用日当等マスター, 幣種マスター, 幣種別レートマスター)
\copy master_kanri_hansuu          FROM '.\files\csv\master_kanri_hansuu_patch.csv'          WITH CSV header ENCODING 'SHIFT-JIS';
\copy master_kanri_ichiran         FROM '.\files\csv\master_kanri_ichiran_patch.csv'         WITH CSV header ENCODING 'SHIFT-JIS';
-- マスター管理一覧の日当等マスターの名称を変更
UPDATE master_kanri_ichiran SET master_name = '国内用日当等マスター' WHERE master_id = 'nittou_nado_master';

-- 幣種マスター
CREATE TABLE HEISHU_MASTER
(
	HEISHU_CD VARCHAR(4) NOT NULL,
	CURRENCY_UNIT VARCHAR(20) NOT NULL,
	COUNTRY_NAME VARCHAR(40),
	CONVERSION_UNIT SMALLINT DEFAULT 1 NOT NULL,
	DECIMAL_POSITION SMALLINT DEFAULT 2 NOT NULL,
	AVAILABILITY_FLG SMALLINT DEFAULT 0 NOT NULL,
	DISPLAY_ORDER SMALLINT DEFAULT 0 NOT NULL,
	PRIMARY KEY (HEISHU_CD)
) WITHOUT OIDS;
COMMENT ON TABLE HEISHU_MASTER IS '幣種マスター';
COMMENT ON COLUMN HEISHU_MASTER.HEISHU_CD IS '幣種コード';
COMMENT ON COLUMN HEISHU_MASTER.CURRENCY_UNIT IS '通貨単位';
COMMENT ON COLUMN HEISHU_MASTER.COUNTRY_NAME IS '国または地域';
COMMENT ON COLUMN HEISHU_MASTER.CONVERSION_UNIT IS '換算単位';
COMMENT ON COLUMN HEISHU_MASTER.DECIMAL_POSITION IS '小数部桁数';
COMMENT ON COLUMN HEISHU_MASTER.AVAILABILITY_FLG IS '使用可否';
COMMENT ON COLUMN HEISHU_MASTER.DISPLAY_ORDER IS '表示順';

-- 幣種別レートマスター
CREATE TABLE RATE_MASTER
(
	HEISHU_CD VARCHAR(4) NOT NULL,
	START_DATE DATE NOT NULL,
	RATE DECIMAL(11,5),
	RATE1 DECIMAL(11,5),
	RATE2 DECIMAL(11,5),
	RATE3 DECIMAL(11,5),
	AVAILABILITY_FLG SMALLINT DEFAULT 1 NOT NULL,
	PRIMARY KEY (HEISHU_CD, START_DATE)
) WITHOUT OIDS;
COMMENT ON TABLE RATE_MASTER IS '幣種別レートマスター';
COMMENT ON COLUMN RATE_MASTER.HEISHU_CD IS '幣種コード';
COMMENT ON COLUMN RATE_MASTER.START_DATE IS '適用開始日時';
COMMENT ON COLUMN RATE_MASTER.RATE IS '適用レート';
COMMENT ON COLUMN RATE_MASTER.RATE1 IS '適用レート(予備)';
COMMENT ON COLUMN RATE_MASTER.RATE2 IS '適用レート(予備)';
COMMENT ON COLUMN RATE_MASTER.RATE3 IS '適用レート(予備)';
COMMENT ON COLUMN RATE_MASTER.AVAILABILITY_FLG IS '初期値使用可否';

-- 海外用日当等マスター
CREATE TABLE KAIGAI_NITTOU_NADO_MASTER
(
	SHUBETSU1 VARCHAR(20) NOT NULL,
	SHUBETSU2 VARCHAR(20) NOT NULL,
	YAKUSHOKU_CD VARCHAR(10) NOT NULL,
	TANKA DECIMAL(15),
	SHOUHYOU_SHORUI_HISSU_FLG VARCHAR(1) NOT NULL,
	NITTOU_SHUKUHAKUHI_FLG VARCHAR(1) NOT NULL,
	PRIMARY KEY (SHUBETSU1, SHUBETSU2, YAKUSHOKU_CD)
) WITHOUT OIDS;
COMMENT ON TABLE KAIGAI_NITTOU_NADO_MASTER IS '海外用日当等マスター';
COMMENT ON COLUMN KAIGAI_NITTOU_NADO_MASTER.SHUBETSU1 IS '種別１';
COMMENT ON COLUMN KAIGAI_NITTOU_NADO_MASTER.SHUBETSU2 IS '種別２';
COMMENT ON COLUMN KAIGAI_NITTOU_NADO_MASTER.YAKUSHOKU_CD IS '役職コード';
COMMENT ON COLUMN KAIGAI_NITTOU_NADO_MASTER.TANKA IS '単価';
COMMENT ON COLUMN KAIGAI_NITTOU_NADO_MASTER.SHOUHYOU_SHORUI_HISSU_FLG IS '証憑書類必須フラグ';
COMMENT ON COLUMN KAIGAI_NITTOU_NADO_MASTER.NITTOU_SHUKUHAKUHI_FLG IS '日当・宿泊費フラグ';

-- 仕訳パターンマスターの変更
ALTER TABLE SHIWAKE_PATTERN_MASTER RENAME TO SHIWAKE_PATTERN_MASTER_OLD;
CREATE TABLE SHIWAKE_PATTERN_MASTER
(
	DENPYOU_KBN VARCHAR(4) NOT NULL,
	SHIWAKE_EDANO INT NOT NULL,
	DELETE_FLG VARCHAR(1) DEFAULT '0' NOT NULL,
	YUUKOU_KIGEN_FROM DATE NOT NULL,
	YUUKOU_KIGEN_TO DATE NOT NULL,
	BUNRUI1 VARCHAR(20) NOT NULL,
	BUNRUI2 VARCHAR(20) NOT NULL,
	BUNRUI3 VARCHAR(20) NOT NULL,
	TORIHIKI_NAME VARCHAR(20) NOT NULL,
	TEKIYOU_FLG VARCHAR(1) NOT NULL,
	TEKIYOU VARCHAR(20),
	DEFAULT_HYOUJI_FLG VARCHAR(1) NOT NULL,
	KOUSAIHI_HYOUJI_FLG VARCHAR(1) NOT NULL,
	KAKE_FLG VARCHAR(1) NOT NULL,
	HYOUJI_JUN INT NOT NULL,
	SHAIN_CD_RENKEI_FLG VARCHAR(1) NOT NULL,
	KARI_FUTAN_BUMON_CD VARCHAR NOT NULL,
	KARI_KAMOKU_CD VARCHAR NOT NULL,
	KARI_KAMOKU_EDABAN_CD VARCHAR NOT NULL,
	KARI_TORIHIKISAKI_CD VARCHAR NOT NULL,
	KARI_PROJECT_CD VARCHAR NOT NULL,
	KARI_KAZEI_KBN VARCHAR NOT NULL,
	KASHI_FUTAN_BUMON_CD1 VARCHAR NOT NULL,
	KASHI_KAMOKU_CD1 VARCHAR NOT NULL,
	KASHI_KAMOKU_EDABAN_CD1 VARCHAR NOT NULL,
	KASHI_TORIHIKISAKI_CD1 VARCHAR NOT NULL,
	KASHI_KAZEI_KBN1 VARCHAR NOT NULL,
	KASHI_FUTAN_BUMON_CD2 VARCHAR NOT NULL,
	KASHI_TORIHIKISAKI_CD2 VARCHAR NOT NULL,
	KASHI_KAMOKU_CD2 VARCHAR NOT NULL,
	KASHI_KAMOKU_EDABAN_CD2 VARCHAR NOT NULL,
	KASHI_KAZEI_KBN2 VARCHAR NOT NULL,
	KASHI_FUTAN_BUMON_CD3 VARCHAR NOT NULL,
	KASHI_TORIHIKISAKI_CD3 VARCHAR NOT NULL,
	KASHI_KAMOKU_CD3 VARCHAR NOT NULL,
	KASHI_KAMOKU_EDABAN_CD3 VARCHAR NOT NULL,
	KASHI_KAZEI_KBN3 VARCHAR NOT NULL,
	KASHI_FUTAN_BUMON_CD4 VARCHAR NOT NULL,
	KASHI_TORIHIKISAKI_CD4 VARCHAR NOT NULL,
	KASHI_KAMOKU_CD4 VARCHAR NOT NULL,
	KASHI_KAMOKU_EDABAN_CD4 VARCHAR NOT NULL,
	KASHI_KAZEI_KBN4 VARCHAR NOT NULL,
	KASHI_FUTAN_BUMON_CD5 VARCHAR NOT NULL,
	KASHI_TORIHIKISAKI_CD5 VARCHAR NOT NULL,
	KASHI_KAMOKU_CD5 VARCHAR NOT NULL,
	KASHI_KAMOKU_EDABAN_CD5 VARCHAR NOT NULL,
	KASHI_KAZEI_KBN5 VARCHAR NOT NULL,
	TOUROKU_USER_ID VARCHAR(30) NOT NULL,
	TOUROKU_TIME TIMESTAMP NOT NULL,
	KOUSHIN_USER_ID VARCHAR(30) NOT NULL,
	KOUSHIN_TIME TIMESTAMP NOT NULL,
	PRIMARY KEY (DENPYOU_KBN, SHIWAKE_EDANO)
) WITHOUT OIDS;
COMMENT ON TABLE SHIWAKE_PATTERN_MASTER IS '仕訳パターンマスター';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.DENPYOU_KBN IS '伝票区分';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.SHIWAKE_EDANO IS '仕訳枝番号';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.DELETE_FLG IS '削除フラグ';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.YUUKOU_KIGEN_FROM IS '有効期限開始日';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.YUUKOU_KIGEN_TO IS '有効期限終了日';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.BUNRUI1 IS '分類1';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.BUNRUI2 IS '分類2';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.BUNRUI3 IS '分類3';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.TORIHIKI_NAME IS '取引名';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.TEKIYOU_FLG IS '摘要フラグ';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.TEKIYOU IS '摘要';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.DEFAULT_HYOUJI_FLG IS 'デフォルト表示フラグ';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KOUSAIHI_HYOUJI_FLG IS '交際費表示フラグ';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KAKE_FLG IS '掛けフラグ';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.HYOUJI_JUN IS '表示順';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.SHAIN_CD_RENKEI_FLG IS '社員コード連携フラグ';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KARI_FUTAN_BUMON_CD IS '借方負担部門コード（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KARI_KAMOKU_CD IS '借方科目コード（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KARI_KAMOKU_EDABAN_CD IS '借方科目枝番コード（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KARI_TORIHIKISAKI_CD IS '借方取引先コード（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KARI_PROJECT_CD IS '借方プロジェクトコード（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KARI_KAZEI_KBN IS '借方課税区分（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_FUTAN_BUMON_CD1 IS '貸方負担部門コード１（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_KAMOKU_CD1 IS '貸方科目コード１（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_KAMOKU_EDABAN_CD1 IS '貸方科目枝番コード１（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_TORIHIKISAKI_CD1 IS '貸方取引先コード１（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_KAZEI_KBN1 IS '貸方課税区分１（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_FUTAN_BUMON_CD2 IS '貸方負担部門コード２（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_TORIHIKISAKI_CD2 IS '貸方取引先コード２（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_KAMOKU_CD2 IS '貸方科目コード２（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_KAMOKU_EDABAN_CD2 IS '貸方科目枝番コード２（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_KAZEI_KBN2 IS '貸方課税区分２（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_FUTAN_BUMON_CD3 IS '貸方負担部門コード３（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_TORIHIKISAKI_CD3 IS '貸方取引先コード３（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_KAMOKU_CD3 IS '貸方科目コード３（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_KAMOKU_EDABAN_CD3 IS '貸方科目枝番コード３（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_KAZEI_KBN3 IS '貸方課税区分３（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_FUTAN_BUMON_CD4 IS '貸方負担部門コード４（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_TORIHIKISAKI_CD4 IS '貸方取引先コード４（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_KAMOKU_CD4 IS '貸方科目コード４（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_KAMOKU_EDABAN_CD4 IS '貸方科目枝番コード４（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_KAZEI_KBN4 IS '貸方課税区分４（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_FUTAN_BUMON_CD5 IS '貸方負担部門コード５（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_TORIHIKISAKI_CD5 IS '貸方取引先コード５（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_KAMOKU_CD5 IS '貸方科目コード５（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_KAMOKU_EDABAN_CD5 IS '貸方科目枝番コード５（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KASHI_KAZEI_KBN5 IS '貸方課税区分５（仕訳パターン）';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.TOUROKU_USER_ID IS '登録ユーザーID';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.TOUROKU_TIME IS '登録日時';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KOUSHIN_USER_ID IS '更新ユーザーID';
COMMENT ON COLUMN SHIWAKE_PATTERN_MASTER.KOUSHIN_TIME IS '更新日時';
INSERT 
INTO SHIWAKE_PATTERN_MASTER( 
	DENPYOU_KBN,
	SHIWAKE_EDANO,
	DELETE_FLG,
	YUUKOU_KIGEN_FROM,
	YUUKOU_KIGEN_TO,
	BUNRUI1,
	BUNRUI2,
	BUNRUI3,
	TORIHIKI_NAME,
	TEKIYOU_FLG,
	TEKIYOU,
	DEFAULT_HYOUJI_FLG,
	KOUSAIHI_HYOUJI_FLG,
	KAKE_FLG,
	HYOUJI_JUN,
	SHAIN_CD_RENKEI_FLG,
	KARI_FUTAN_BUMON_CD,
	KARI_KAMOKU_CD,
	KARI_KAMOKU_EDABAN_CD,
	KARI_TORIHIKISAKI_CD,
	KARI_PROJECT_CD,
	KARI_KAZEI_KBN,
	KASHI_FUTAN_BUMON_CD1,
	KASHI_KAMOKU_CD1,
	KASHI_KAMOKU_EDABAN_CD1,
	KASHI_TORIHIKISAKI_CD1,
	KASHI_KAZEI_KBN1,
	KASHI_FUTAN_BUMON_CD2,
	KASHI_TORIHIKISAKI_CD2,
	KASHI_KAMOKU_CD2,
	KASHI_KAMOKU_EDABAN_CD2,
	KASHI_KAZEI_KBN2,
	KASHI_FUTAN_BUMON_CD3,
	KASHI_TORIHIKISAKI_CD3,
	KASHI_KAMOKU_CD3,
	KASHI_KAMOKU_EDABAN_CD3,
	KASHI_KAZEI_KBN3,
	KASHI_FUTAN_BUMON_CD4,
	KASHI_TORIHIKISAKI_CD4,
	KASHI_KAMOKU_CD4,
	KASHI_KAMOKU_EDABAN_CD4,
	KASHI_KAZEI_KBN4,
	KASHI_FUTAN_BUMON_CD5,
	KASHI_TORIHIKISAKI_CD5,
	KASHI_KAMOKU_CD5,
	KASHI_KAMOKU_EDABAN_CD5,
	KASHI_KAZEI_KBN5,
	TOUROKU_USER_ID,
	TOUROKU_TIME,
	KOUSHIN_USER_ID,
	KOUSHIN_TIME
) 
SELECT
	DENPYOU_KBN,
	SHIWAKE_EDANO,
	DELETE_FLG,
	YUUKOU_KIGEN_FROM,
	YUUKOU_KIGEN_TO,
	BUNRUI1,
	BUNRUI2,
	BUNRUI3,
	TORIHIKI_NAME,
	TEKIYOU_FLG,
	TEKIYOU,
	DEFAULT_HYOUJI_FLG,
	KOUSAIHI_HYOUJI_FLG,
	KAKE_FLG,
	HYOUJI_JUN,
	SHAIN_CD_RENKEI_FLG,
	KARI_FUTAN_BUMON_CD,
	KARI_KAMOKU_CD,
	KARI_KAMOKU_EDABAN_CD,
	KARI_TORIHIKISAKI_CD,
	KARI_PROJECT_CD,
	KARI_KAZEI_KBN,
	KASHI_FUTAN_BUMON_CD1,
	KASHI_KAMOKU_CD1,
	KASHI_KAMOKU_EDABAN_CD1,
	KASHI_TORIHIKISAKI_CD1,
	KASHI_KAZEI_KBN1,
	KASHI_FUTAN_BUMON_CD2,
	KASHI_TORIHIKISAKI_CD2,
	KASHI_KAMOKU_CD2,
	KASHI_KAMOKU_EDABAN_CD2,
	KASHI_KAZEI_KBN2,
	KASHI_FUTAN_BUMON_CD3,
	KASHI_TORIHIKISAKI_CD3,
	KASHI_KAMOKU_CD3,
	KASHI_KAMOKU_EDABAN_CD3,
	KASHI_KAZEI_KBN3,
	KASHI_FUTAN_BUMON_CD4,
	KASHI_TORIHIKISAKI_CD4,
	KASHI_KAMOKU_CD4,
	KASHI_KAMOKU_EDABAN_CD4,
	KASHI_KAZEI_KBN4,
	'',
	'',
	'',
	'',
	'',
	TOUROKU_USER_ID,
	TOUROKU_TIME,
	KOUSHIN_USER_ID,
	KOUSHIN_TIME
FROM
  SHIWAKE_PATTERN_MASTER_OLD;
DROP TABLE SHIWAKE_PATTERN_MASTER_OLD;

-- 業務ロール割り当てプライマリキー追加
ALTER TABLE GYOUMU_ROLE_WARIATE RENAME TO GYOUMU_ROLE_WARIATE_OLD;
CREATE TABLE GYOUMU_ROLE_WARIATE
(
	USER_ID VARCHAR(30) NOT NULL,
	GYOUMU_ROLE_ID VARCHAR(5) NOT NULL,
	YUUKOU_KIGEN_FROM DATE NOT NULL,
	YUUKOU_KIGEN_TO DATE NOT NULL,
	SHORI_BUMON_CD VARCHAR(8) NOT NULL,
	TOUROKU_USER_ID VARCHAR(30) NOT NULL,
	TOUROKU_TIME TIMESTAMP NOT NULL,
	KOUSHIN_USER_ID VARCHAR(30) NOT NULL,
	KOUSHIN_TIME TIMESTAMP NOT NULL,
	PRIMARY KEY (USER_ID, GYOUMU_ROLE_ID, SHORI_BUMON_CD)
) WITHOUT OIDS;
COMMENT ON TABLE GYOUMU_ROLE_WARIATE IS '業務ロール割り当て';
COMMENT ON COLUMN GYOUMU_ROLE_WARIATE.USER_ID IS 'ユーザーID';
COMMENT ON COLUMN GYOUMU_ROLE_WARIATE.GYOUMU_ROLE_ID IS '業務ロールID';
COMMENT ON COLUMN GYOUMU_ROLE_WARIATE.YUUKOU_KIGEN_FROM IS '有効期限開始日';
COMMENT ON COLUMN GYOUMU_ROLE_WARIATE.YUUKOU_KIGEN_TO IS '有効期限終了日';
COMMENT ON COLUMN GYOUMU_ROLE_WARIATE.SHORI_BUMON_CD IS '処理部門コード';
COMMENT ON COLUMN GYOUMU_ROLE_WARIATE.TOUROKU_USER_ID IS '登録ユーザーID';
COMMENT ON COLUMN GYOUMU_ROLE_WARIATE.TOUROKU_TIME IS '登録日時';
COMMENT ON COLUMN GYOUMU_ROLE_WARIATE.KOUSHIN_USER_ID IS '更新ユーザーID';
COMMENT ON COLUMN GYOUMU_ROLE_WARIATE.KOUSHIN_TIME IS '更新日時';
INSERT 
INTO GYOUMU_ROLE_WARIATE(
	USER_ID,
	GYOUMU_ROLE_ID,
	YUUKOU_KIGEN_FROM,
	YUUKOU_KIGEN_TO,
	SHORI_BUMON_CD,
	TOUROKU_USER_ID,
	TOUROKU_TIME,
	KOUSHIN_USER_ID,
	KOUSHIN_TIME
)
SELECT 
	USER_ID,
	GYOUMU_ROLE_ID,
	YUUKOU_KIGEN_FROM,
	YUUKOU_KIGEN_TO,
	SHORI_BUMON_CD,
	TOUROKU_USER_ID,
	TOUROKU_TIME,
	KOUSHIN_USER_ID,
	KOUSHIN_TIME
FROM
	GYOUMU_ROLE_WARIATE_OLD;
DROP TABLE GYOUMU_ROLE_WARIATE_OLD;

-- マスター取込用SQLの更新(NOT IN句)
DELETE FROM master_torikomi_ichiran_de3;
\copy master_torikomi_ichiran_de3  FROM '.\files\csv\master_torikomi_ichiran_de3.csv'  WITH CSV header ENCODING 'SHIFT-JIS';
DELETE FROM master_torikomi_ichiran_sias;
\copy master_torikomi_ichiran_sias FROM '.\files\csv\master_torikomi_ichiran_sias.csv' WITH CSV header ENCODING 'SHIFT-JIS';

-- マスター期間取込用SQLの更新(NOT IN句)
DELETE FROM master_torikomi_term_ichiran_de3;
\copy master_torikomi_term_ichiran_de3  FROM '.\files\csv\master_torikomi_term_ichiran_de3.csv'  WITH CSV header ENCODING 'SHIFT-JIS';
DELETE FROM master_torikomi_term_ichiran_sias;
\copy master_torikomi_term_ichiran_sias FROM '.\files\csv\master_torikomi_term_ichiran_sias.csv' WITH CSV header ENCODING 'SHIFT-JIS';

commit;